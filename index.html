<!DOCTYPE html>
<html lang="id" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amaliah Ramadhan 1447 H - SMAN 10 Pinrang</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        *{font-family:'Poppins',sans-serif}
        .arabic{font-family:'Amiri',serif;direction:rtl;line-height:2.2}
        .bg-islamic{background:linear-gradient(135deg,#0c4a3e 0%,#1a6b4a 30%,#0d5c3f 60%,#064e3b 100%)}
        .gold-text{color:#d4a853}
        .gold-border{border-color:#d4a853}
        .card-hover{transition:all .3s ease}
        .card-hover:hover{transform:translateY(-4px);box-shadow:0 12px 30px rgba(0,0,0,.15)}
        .nav-active{background:rgba(212,168,83,.2);border-bottom:3px solid #d4a853;color:#d4a853}
        .fade-in{animation:fadeIn .4s ease-in}
        @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
        @keyframes pulse-glow{0%,100%{box-shadow:0 0 5px rgba(212,168,83,.3)}50%{box-shadow:0 0 20px rgba(212,168,83,.6)}}
        .pulse-glow{animation:pulse-glow 2s infinite}
        .pattern-bg{background-image:url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23d4a853' fill-opacity='0.06'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")}
        .checkbox-islamic{accent-color:#d4a853;width:20px;height:20px}
        .tab-content{display:none}.tab-content.active{display:block}
        .modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);z-index:100;display:none;justify-content:center;align-items:center}
        .modal-overlay.show{display:flex}
        .toast{position:fixed;top:20px;right:20px;z-index:200;transform:translateX(400px);transition:transform .4s ease}
        .toast.show{transform:translateX(0)}
        ::-webkit-scrollbar{width:8px}::-webkit-scrollbar-track{background:#f1f1f1}::-webkit-scrollbar-thumb{background:#1a6b4a;border-radius:4px}
        .login-bg{background:linear-gradient(135deg,#064e3b,#0c4a3e,#1a6b4a);height:100vh;overflow:hidden}
        .ayah-text{border-bottom:1px dashed #e5e7eb;padding:12px 0}.ayah-text:last-child{border-bottom:none}
        .surah-item{transition:all .2s}.surah-item:hover{background:rgba(212,168,83,.1);transform:translateX(4px)}
        .school-logo{width:80px;height:80px;border-radius:50%;border:3px solid #d4a853;padding:3px;background:white;display:flex;align-items:center;justify-content:center;margin:0 auto}
        .school-logo-sm{width:42px;height:42px;border-radius:50%;border:2px solid #d4a853;padding:2px;background:white;display:flex;align-items:center;justify-content:center}
        .school-logo svg,.school-logo-sm svg{width:100%;height:100%}
        .hafalan-card{transition:all .3s}.hafalan-card:hover{transform:scale(1.02);box-shadow:0 8px 25px rgba(0,0,0,.1)}
        .status-lancar{background:#dcfce7;color:#166534;border:1px solid #86efac}
        .status-kurang{background:#fef9c3;color:#854d0e;border:1px solid #fde047}
        .status-belum{background:#fee2e2;color:#991b1b;border:1px solid #fca5a5}
        .status-menunggu{background:#e0e7ff;color:#3730a3;border:1px solid #a5b4fc}
    </style>
</head>
<body class="bg-gray-50 min-h-screen">

<div id="toast" class="toast bg-green-600 text-white px-6 py-3 rounded-lg shadow-xl flex items-center gap-2">
    <span id="toastIcon">âœ…</span><span id="toastMsg">Berhasil!</span>
</div>

<!-- ==================== LOGIN SCREEN ==================== -->
<div id="loginScreen" class="login-bg pattern-bg flex items-center justify-center p-2">
    <div class="w-full max-w-md">
        <div class="text-center mb-3">
            <!-- LOGO SMAN 10 PINRANG -->
            <div class="school-logo mx-auto mb-2" style="width:60px;height:60px">
                <svg viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="60" cy="60" r="56" fill="#064e3b" stroke="#d4a853" stroke-width="3"/>
                    <circle cx="60" cy="60" r="48" fill="none" stroke="#d4a853" stroke-width="1.5"/>
                    <text x="60" y="22" text-anchor="middle" fill="#d4a853" font-size="7" font-weight="bold" font-family="Poppins">SMAN 10</text>
                    <polygon points="60,28 63,38 73,38 65,44 68,54 60,48 52,54 55,44 47,38 57,38" fill="#d4a853"/>
                    <rect x="42" y="58" width="36" height="24" rx="2" fill="#1a6b4a" stroke="#d4a853" stroke-width="1"/>
                    <line x1="60" y1="58" x2="60" y2="82" stroke="#d4a853" stroke-width="1"/>
                    <line x1="46" y1="64" x2="57" y2="64" stroke="#d4a853" stroke-width="0.8"/>
                    <line x1="46" y1="68" x2="57" y2="68" stroke="#d4a853" stroke-width="0.8"/>
                    <line x1="46" y1="72" x2="57" y2="72" stroke="#d4a853" stroke-width="0.8"/>
                    <line x1="63" y1="64" x2="74" y2="64" stroke="#d4a853" stroke-width="0.8"/>
                    <line x1="63" y1="68" x2="74" y2="68" stroke="#d4a853" stroke-width="0.8"/>
                    <line x1="63" y1="72" x2="74" y2="72" stroke="#d4a853" stroke-width="0.8"/>
                    <line x1="50" y1="86" x2="60" y2="76" stroke="#d4a853" stroke-width="1.5" stroke-linecap="round"/>
                    <line x1="70" y1="86" x2="60" y2="76" stroke="#d4a853" stroke-width="1.5" stroke-linecap="round"/>
                    <text x="60" y="98" text-anchor="middle" fill="#d4a853" font-size="6.5" font-weight="bold" font-family="Poppins">PINRANG</text>
                    <path d="M95,25 A12,12,0,1,1,85,40 A9,9,0,1,0,95,25" fill="#d4a853"/>
                    <circle cx="98" cy="22" r="2" fill="#d4a853"/>
                </svg>
            </div>
            <h1 class="arabic text-xl gold-text mb-1">Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø§Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ†Ù Ø§Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù</h1>
            <h2 class="text-white text-lg font-bold">Amaliah Ramadhan 1447 H</h2>
            <p class="text-emerald-300 text-xs font-semibold">SMAN 10 Pinrang â€” Pencatatan Ibadah & Setor Hafalan</p>
        </div>
        <div class="bg-white rounded-2xl shadow-2xl p-5">
            <h3 class="text-lg font-bold text-emerald-800 mb-3 text-center">ğŸ” Login</h3>
            <div class="mb-2.5">
                <label class="block text-xs font-medium text-gray-700 mb-0.5">Masuk Sebagai</label>
                <select id="loginRole" onchange="updateLoginLabel()" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    <option value="siswa">ğŸ‘¨â€ğŸ“ Siswa</option>
                    <option value="guru">ğŸ‘¨â€ğŸ« Guru Agama Islam</option>
                    <option value="wali">ğŸ‘©â€ğŸ« Wali Kelas</option>
                    <option value="admin">ğŸ‘¨â€ğŸ’¼ Administrator</option>
                </select>
            </div>
            <div class="mb-2.5">
                <label class="block text-xs font-medium text-gray-700 mb-0.5" id="loginIdLabel">ğŸ“‹ NIS (Nomor Induk Siswa)</label>
                <input type="text" id="loginId" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-emerald-500" placeholder="Masukkan NIS">
            </div>
            <div class="mb-3">
                <label class="block text-xs font-medium text-gray-700 mb-0.5">ğŸ”‘ Password</label>
                <div class="relative">
                    <input type="password" id="loginPassword" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-emerald-500" placeholder="Masukkan password" onkeydown="if(event.key==='Enter')doLogin()">
                    <button onclick="togglePw()" class="absolute right-3 top-2 text-gray-400 hover:text-gray-600 text-sm">ğŸ‘</button>
                </div>
            </div>
            <div id="loginError" class="hidden bg-red-50 text-red-600 text-xs p-2 rounded-lg mb-2"></div>
            <button onclick="doLogin()" id="btnLogin" class="w-full bg-emerald-600 hover:bg-emerald-700 text-white font-semibold py-2.5 rounded-xl shadow-lg transition flex items-center justify-center gap-2 text-sm">ğŸ” Masuk</button>
            <div class="mt-3 bg-gray-50 rounded-xl p-3">
                <p class="text-xs font-semibold text-gray-500 mb-1">ğŸ“Œ Akun Default (dibuat saat Init Database):</p>
                <div class="grid grid-cols-2 gap-x-4 gap-y-0.5 text-xs text-gray-500">
                    <p>ğŸ‘¨â€ğŸ’¼ <b>admin</b> / <b>admin123</b></p>
                    <p>ğŸ‘¨â€ğŸ« <b>gurupai</b> / <b>guru123</b></p>
                    <p>ğŸ‘©â€ğŸ« <b>wali10a</b> / <b>wali123</b></p>
                    <p>ğŸ‘¨â€ğŸ“ <b>10001</b> / <b>siswa123</b></p>
                </div>
                <p class="text-xs text-gray-400 mt-1 italic">âš ï¸ Hubungkan ke Google Spreadsheet untuk autentikasi real</p>
            </div>
        </div>
        <div class="text-center mt-3">
            <p class="text-emerald-300 text-xs">Â© 2026 Amaliah Ramadhan 1447 H â€” SMAN 10 Pinrang</p>
            <p class="text-emerald-200 text-xs mt-0.5 font-medium">ğŸ’» Dikembangkan oleh <span class="gold-text font-bold">Murdani</span> â€” 2026</p>
        </div>
    </div>
</div>

<!-- ==================== MAIN APP ==================== -->
<div id="mainApp" class="hidden">

<!-- HEADER -->
<header class="bg-islamic pattern-bg text-white relative overflow-hidden">
    <div class="absolute top-0 right-0 opacity-10 text-9xl select-none">â˜ª</div>
    <div class="container mx-auto px-4 py-3 relative z-10">
        <div class="flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="school-logo-sm flex-shrink-0">
                    <svg viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="60" cy="60" r="56" fill="#064e3b" stroke="#d4a853" stroke-width="3"/>
                        <circle cx="60" cy="60" r="48" fill="none" stroke="#d4a853" stroke-width="1.5"/>
                        <text x="60" y="22" text-anchor="middle" fill="#d4a853" font-size="7" font-weight="bold" font-family="Poppins">SMAN 10</text>
                        <polygon points="60,28 63,38 73,38 65,44 68,54 60,48 52,54 55,44 47,38 57,38" fill="#d4a853"/>
                        <rect x="42" y="58" width="36" height="24" rx="2" fill="#1a6b4a" stroke="#d4a853" stroke-width="1"/>
                        <line x1="60" y1="58" x2="60" y2="82" stroke="#d4a853" stroke-width="1"/>
                        <text x="60" y="98" text-anchor="middle" fill="#d4a853" font-size="6.5" font-weight="bold" font-family="Poppins">PINRANG</text>
                        <path d="M95,25 A12,12,0,1,1,85,40 A9,9,0,1,0,95,25" fill="#d4a853"/>
                    </svg>
                </div>
                <div>
                    <h1 class="text-sm md:text-xl font-bold gold-text">Amaliah Ramadhan 1447 H</h1>
                    <p class="text-emerald-200 text-xs">ğŸ“ SMAN 10 Pinrang â€¢ Ramadhan 1447 H / 2026</p>
                </div>
            </div>
            <div class="flex items-center gap-3">
                <div class="text-right hidden sm:block">
                    <p class="text-sm font-medium" id="headerName">-</p>
                    <p class="text-xs text-emerald-300" id="headerRole">-</p>
                </div>
                <div class="w-10 h-10 rounded-full bg-emerald-700 flex items-center justify-center text-lg" id="headerAvatar">ğŸ‘¤</div>
                <button onclick="doLogout()" class="bg-red-500/20 hover:bg-red-500/40 text-red-200 px-3 py-1.5 rounded-lg text-xs transition">ğŸšª</button>
            </div>
        </div>
    </div>
</header>

<!-- NAVIGATION -->
<nav class="bg-emerald-900 sticky top-0 z-50 shadow-lg overflow-x-auto">
    <div class="container mx-auto flex whitespace-nowrap" id="navContainer"></div>
</nav>

<!-- ==================== BERANDA ==================== -->
<div id="tab-beranda" class="tab-content active fade-in">
    <div class="container mx-auto px-4 py-6 max-w-6xl">
        <div class="bg-gradient-to-r from-emerald-700 to-emerald-900 rounded-2xl p-6 text-white mb-6 pattern-bg shadow-xl">
            <div class="flex items-center gap-4 mb-3">
                <div class="school-logo-sm flex-shrink-0" style="width:50px;height:50px">
                    <svg viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="60" cy="60" r="56" fill="#064e3b" stroke="#d4a853" stroke-width="3"/>
                        <polygon points="60,28 63,38 73,38 65,44 68,54 60,48 52,54 55,44 47,38 57,38" fill="#d4a853"/>
                        <rect x="42" y="58" width="36" height="24" rx="2" fill="#1a6b4a" stroke="#d4a853" stroke-width="1"/>
                        <line x1="60" y1="58" x2="60" y2="82" stroke="#d4a853" stroke-width="1"/>
                        <text x="60" y="98" text-anchor="middle" fill="#d4a853" font-size="7" font-weight="bold">PINRANG</text>
                    </svg>
                </div>
                <div>
                    <h3 class="text-2xl font-bold">ğŸŒ™ Marhaban Ya Ramadhan!</h3>
                    <p class="text-emerald-300 text-sm font-medium">SMAN 10 Pinrang</p>
                </div>
            </div>
            <p class="text-emerald-200 mb-3" id="welcomeMsg">Selamat datang!</p>
            <div class="arabic text-2xl gold-text text-center my-3 bg-emerald-800/50 rounded-xl p-4">Ø´ÙÙ‡Ù’Ø±Ù Ø±ÙÙ…ÙØ¶ÙØ§Ù†Ù Ø§Ù„ÙÙ‘Ø°ÙÙŠ Ø£ÙÙ†Ù’Ø²ÙÙ„Ù ÙÙÙŠÙ‡Ù Ø§Ù„Ù’Ù‚ÙØ±Ù’Ø¢Ù†Ù Ù‡ÙØ¯Ù‹Ù‰ Ù„ÙÙ„Ù†ÙÙ‘Ø§Ø³Ù</div>
            <p class="text-center text-emerald-200 text-xs italic">"Bulan Ramadhan diturunkan Al-Quran sebagai petunjuk bagi manusia" (QS. Al-Baqarah: 185)</p>
        </div>
        <div id="dashboardContent"></div>
        <div class="bg-white rounded-2xl shadow-lg p-6 mt-6">
            <h3 class="text-lg font-bold text-emerald-800 mb-4">ğŸ—“ï¸ Tracker 30 Hari Ramadhan</h3>
            <div class="grid grid-cols-6 md:grid-cols-10 gap-2" id="ramadhanDays"></div>
        </div>
    </div>
</div>

<!-- ==================== AMALIAH ==================== -->
<div id="tab-amaliah" class="tab-content fade-in">
    <div class="container mx-auto px-4 py-6 max-w-3xl">
        <div class="bg-white rounded-2xl shadow-lg p-6">
            <h3 class="text-xl font-bold text-emerald-800 mb-2">âœ… Form Amaliah Harian Ramadhan</h3>
            <p class="text-sm text-gray-500 mb-5">Isi data ibadah harianmu setiap hari</p>
            <form id="formAmaliah" onsubmit="submitAmaliah(event)">
                <div class="grid md:grid-cols-2 gap-4 mb-5">
                    <div><label class="block text-sm font-medium text-gray-700 mb-1">ğŸ“… Tanggal</label><input type="date" id="amTanggal" required class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-emerald-500"></div>
                    <div><label class="block text-sm font-medium text-gray-700 mb-1">ğŸŒ™ Hari Ramadhan Ke-</label><select id="amHari" required class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-emerald-500"><option value="">Pilih Hari</option></select></div>
                </div>
                <div class="bg-emerald-50 rounded-xl p-4 mb-4">
                    <h4 class="font-semibold text-emerald-800 mb-3">ğŸ•Œ Shalat 5 Waktu</h4>
                    <div class="grid grid-cols-2 md:grid-cols-5 gap-2">
                        <label class="flex items-center gap-2 bg-white rounded-lg p-2.5 cursor-pointer hover:bg-emerald-100 transition text-sm"><input type="checkbox" id="cb_subuh" class="checkbox-islamic">ğŸŒ… Subuh</label>
                        <label class="flex items-center gap-2 bg-white rounded-lg p-2.5 cursor-pointer hover:bg-emerald-100 transition text-sm"><input type="checkbox" id="cb_dzuhur" class="checkbox-islamic">â˜€ï¸ Dzuhur</label>
                        <label class="flex items-center gap-2 bg-white rounded-lg p-2.5 cursor-pointer hover:bg-emerald-100 transition text-sm"><input type="checkbox" id="cb_ashar" class="checkbox-islamic">ğŸŒ¤ï¸ Ashar</label>
                        <label class="flex items-center gap-2 bg-white rounded-lg p-2.5 cursor-pointer hover:bg-emerald-100 transition text-sm"><input type="checkbox" id="cb_maghrib" class="checkbox-islamic">ğŸŒ… Maghrib</label>
                        <label class="flex items-center gap-2 bg-white rounded-lg p-2.5 cursor-pointer hover:bg-emerald-100 transition text-sm"><input type="checkbox" id="cb_isya" class="checkbox-islamic">ğŸŒ™ Isya</label>
                    </div>
                </div>
                <div class="bg-amber-50 rounded-xl p-4 mb-4">
                    <h4 class="font-semibold text-amber-800 mb-3">â­ Ibadah Sunnah</h4>
                    <div class="grid grid-cols-2 gap-2">
                        <label class="flex items-center gap-2 bg-white rounded-lg p-2.5 cursor-pointer hover:bg-amber-100 transition text-sm"><input type="checkbox" id="cb_tarawih" class="checkbox-islamic">ğŸŒ™ Tarawih</label>
                        <label class="flex items-center gap-2 bg-white rounded-lg p-2.5 cursor-pointer hover:bg-amber-100 transition text-sm"><input type="checkbox" id="cb_witir" class="checkbox-islamic">ğŸŒŸ Witir</label>
                        <label class="flex items-center gap-2 bg-white rounded-lg p-2.5 cursor-pointer hover:bg-amber-100 transition text-sm"><input type="checkbox" id="cb_dhuha" class="checkbox-islamic">â˜€ï¸ Dhuha</label>
                        <label class="flex items-center gap-2 bg-white rounded-lg p-2.5 cursor-pointer hover:bg-amber-100 transition text-sm"><input type="checkbox" id="cb_tahajud" class="checkbox-islamic">ğŸŒŒ Tahajud</label>
                        <label class="flex items-center gap-2 bg-white rounded-lg p-2.5 cursor-pointer hover:bg-amber-100 transition text-sm"><input type="checkbox" id="cb_sahur" class="checkbox-islamic">ğŸ½ï¸ Sahur</label>
                        <label class="flex items-center gap-2 bg-white rounded-lg p-2.5 cursor-pointer hover:bg-amber-100 transition text-sm"><input type="checkbox" id="cb_puasa" class="checkbox-islamic">ğŸ•Œ Puasa</label>
                        <label class="flex items-center gap-2 bg-white rounded-lg p-2.5 cursor-pointer hover:bg-amber-100 transition text-sm"><input type="checkbox" id="cb_sedekah" class="checkbox-islamic">ğŸ’° Sedekah</label>
                        <label class="flex items-center gap-2 bg-white rounded-lg p-2.5 cursor-pointer hover:bg-amber-100 transition text-sm"><input type="checkbox" id="cb_dzikir" class="checkbox-islamic">ğŸ“¿ Dzikir & Doa</label>
                    </div>
                </div>
                <div class="bg-blue-50 rounded-xl p-4 mb-4">
                    <h4 class="font-semibold text-blue-800 mb-3">ğŸ“– Tadarus Al-Quran</h4>
                    <div class="grid md:grid-cols-2 gap-3">
                        <div><label class="block text-sm text-gray-600 mb-1">Juz yang dibaca</label><select id="amJuz" class="w-full border border-gray-300 rounded-lg px-4 py-2"><option value="">Pilih Juz</option></select></div>
                        <div><label class="block text-sm text-gray-600 mb-1">Jumlah Halaman</label><input type="number" id="amHalaman" min="0" max="30" class="w-full border border-gray-300 rounded-lg px-4 py-2" placeholder="0"></div>
                    </div>
                </div>
                <div class="bg-purple-50 rounded-xl p-4 mb-4">
                    <h4 class="font-semibold text-purple-800 mb-3">ğŸ“ Hafalan Surat</h4>
                    <input type="text" id="amHafalan" class="w-full border border-gray-300 rounded-lg px-4 py-2" placeholder="Contoh: Al-Fatihah, An-Nas">
                </div>
                <div class="mb-5">
                    <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ“ Catatan</label>
                    <textarea id="amCatatan" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2" placeholder="Catatan tambahan..."></textarea>
                </div>
                <button type="submit" id="btnSubmitAmaliah" class="w-full bg-emerald-600 hover:bg-emerald-700 text-white font-semibold py-3 rounded-xl shadow-lg transition">ğŸ’¾ Simpan Amaliah</button>
            </form>
        </div>
    </div>
</div>

<!-- ==================== SETOR HAFALAN JUZ 30 (SISWA) ==================== -->
<div id="tab-hafalan" class="tab-content fade-in">
    <div class="container mx-auto px-4 py-6 max-w-4xl">
        <div class="bg-gradient-to-r from-emerald-700 to-emerald-900 rounded-2xl p-6 text-white mb-6 pattern-bg shadow-xl">
            <h3 class="text-xl font-bold gold-text mb-1">ğŸ“— Setor Hafalan Juz 30</h3>
            <p class="text-emerald-200 text-sm">Pilih surat yang akan disetorkan ke Guru Agama Islam</p>
        </div>

        <!-- Form Setor Hafalan -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
            <h4 class="font-bold text-emerald-800 mb-4">ğŸ“ Form Setor Hafalan</h4>
            <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ“… Tanggal Setor</label>
                    <input type="date" id="hfTanggal" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-emerald-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ“– Pilih Surat (Juz 30)</label>
                    <select id="hfSurat" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-emerald-500"><option value="">Pilih Surat</option></select>
                </div>
            </div>
            <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ“‹ Dari Ayat</label>
                    <input type="number" id="hfDariAyat" min="1" class="w-full border border-gray-300 rounded-lg px-4 py-2" placeholder="1" value="1">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ“‹ Sampai Ayat</label>
                    <input type="number" id="hfSampaiAyat" min="1" class="w-full border border-gray-300 rounded-lg px-4 py-2" placeholder="Terakhir">
                </div>
            </div>
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ“ Catatan Siswa</label>
                <textarea id="hfCatatan" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2" placeholder="Catatan untuk guru..."></textarea>
            </div>
            <button onclick="submitSetorHafalan()" id="btnSetorHafalan" class="w-full bg-emerald-600 hover:bg-emerald-700 text-white font-semibold py-3 rounded-xl shadow-lg transition">ğŸ“¤ Setor Hafalan ke Guru PAI</button>
        </div>

        <!-- Riwayat Setoran -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
            <div class="flex justify-between items-center mb-4">
                <h4 class="font-bold text-emerald-800">ğŸ“‹ Riwayat Setoran Saya</h4>
                <button onclick="loadMyHafalan()" class="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-lg text-sm">ğŸ”„ Muat</button>
            </div>
            <div id="myHafalanList"><p class="text-gray-400 text-center py-6">Klik "Muat" untuk melihat riwayat</p></div>
        </div>

        <!-- Daftar Surat Juz 30 -->
        <div class="bg-white rounded-2xl shadow-lg p-6">
            <h4 class="font-bold text-emerald-800 mb-4">ğŸ“š Daftar Surat Juz 30 (An-Naba' - An-Nas)</h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-2" id="juz30SurahList"></div>
        </div>
    </div>
</div>

<!-- ==================== DATA HAFALAN (GURU PAI) ==================== -->
<div id="tab-datahafalan" class="tab-content fade-in">
    <div class="container mx-auto px-4 py-6 max-w-6xl">
        <div class="bg-gradient-to-r from-amber-600 to-amber-800 rounded-2xl p-6 text-white mb-6 shadow-xl">
            <h3 class="text-xl font-bold mb-1">ğŸ“— Penilaian Setor Hafalan Juz 30</h3>
            <p class="text-amber-200 text-sm">Verifikasi dan nilai hafalan siswa SMAN 10 Pinrang</p>
        </div>
        <div class="bg-white rounded-2xl shadow-lg p-6">
            <div class="flex flex-wrap gap-3 mb-4">
                <button onclick="loadAllHafalan()" class="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-lg text-sm">ğŸ”„ Muat Data Hafalan</button>
                <input type="text" id="searchHafalan" placeholder="ğŸ” Cari nama siswa..." class="border border-gray-300 rounded-lg px-4 py-2 text-sm flex-1 min-w-48" oninput="filterHafalanData()">
                <select id="filterHafalanStatus" onchange="filterHafalanData()" class="border border-gray-300 rounded-lg px-3 py-2 text-sm">
                    <option value="">Semua Status</option>
                    <option value="Menunggu">â³ Menunggu</option>
                    <option value="Lancar">âœ… Lancar</option>
                    <option value="Kurang Lancar">âš ï¸ Kurang Lancar</option>
                    <option value="Belum Lancar">âŒ Belum Lancar</option>
                </select>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full text-xs md:text-sm">
                    <thead><tr class="bg-amber-700 text-white">
                        <th class="px-2 py-2">No</th><th class="px-2 py-2">Nama</th><th class="px-2 py-2">Kelas</th><th class="px-2 py-2">Surat</th><th class="px-2 py-2">Ayat</th><th class="px-2 py-2">Tanggal</th><th class="px-2 py-2">Status</th><th class="px-2 py-2">Nilai</th><th class="px-2 py-2">Aksi</th>
                    </tr></thead>
                    <tbody id="hafalanBody"><tr><td colspan="9" class="text-center py-8 text-gray-400">Klik "Muat Data Hafalan"</td></tr></tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Hafalan Assessment Modal -->
<div id="hafalanModal" class="modal-overlay" onclick="if(event.target===this)closeHafalanModal()">
    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-lg m-4 p-6">
        <h3 class="text-lg font-bold text-emerald-800 mb-4">ğŸ“ Penilaian Hafalan</h3>
        <input type="hidden" id="hmRowIndex">
        <div class="bg-emerald-50 rounded-xl p-4 mb-4">
            <p class="text-sm"><strong>Siswa:</strong> <span id="hmNama"></span></p>
            <p class="text-sm"><strong>Surat:</strong> <span id="hmSurat"></span></p>
            <p class="text-sm"><strong>Ayat:</strong> <span id="hmAyat"></span></p>
        </div>
        <div class="mb-4">
            <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“Š Status Penilaian</label>
            <div class="grid grid-cols-3 gap-2">
                <button onclick="setHmStatus('Lancar')" class="hm-status-btn bg-green-100 hover:bg-green-300 text-green-800 px-3 py-2 rounded-lg text-sm font-medium border-2 border-transparent transition" data-val="Lancar">âœ… Lancar</button>
                <button onclick="setHmStatus('Kurang Lancar')" class="hm-status-btn bg-yellow-100 hover:bg-yellow-300 text-yellow-800 px-3 py-2 rounded-lg text-sm font-medium border-2 border-transparent transition" data-val="Kurang Lancar">âš ï¸ Kurang</button>
                <button onclick="setHmStatus('Belum Lancar')" class="hm-status-btn bg-red-100 hover:bg-red-300 text-red-800 px-3 py-2 rounded-lg text-sm font-medium border-2 border-transparent transition" data-val="Belum Lancar">âŒ Belum</button>
            </div>
        </div>
        <div class="mb-4">
            <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ’¯ Nilai (0-100)</label>
            <input type="number" id="hmNilai" min="0" max="100" class="w-full border border-gray-300 rounded-lg px-4 py-2" placeholder="Masukkan nilai">
        </div>
        <div class="mb-4">
            <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ“ Catatan Guru</label>
            <textarea id="hmCatatanGuru" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2" placeholder="Catatan penilaian..."></textarea>
        </div>
        <div class="flex gap-2">
            <button onclick="submitPenilaianHafalan()" class="flex-1 bg-emerald-600 hover:bg-emerald-700 text-white font-semibold py-2.5 rounded-xl transition">ğŸ’¾ Simpan Penilaian</button>
            <button onclick="closeHafalanModal()" class="bg-gray-200 hover:bg-gray-300 px-4 py-2.5 rounded-xl text-sm">Batal</button>
        </div>
    </div>
</div>

<!-- ==================== AL-QURAN 30 JUZ ==================== -->
<div id="tab-quran" class="tab-content fade-in">
    <div class="container mx-auto px-4 py-6 max-w-5xl">
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
            <h3 class="text-xl font-bold text-emerald-800 mb-2">ğŸ“– Al-Quran 30 Juz - 114 Surat</h3>
            <p class="text-sm text-gray-500 mb-4">Baca Al-Quran lengkap dengan terjemahan Bahasa Indonesia</p>
            <div class="flex gap-2 mb-4">
                <button onclick="showQuranView('surah')" id="btnViewSurah" class="bg-emerald-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition">ğŸ“‹ Per Surat</button>
                <button onclick="showQuranView('juz')" id="btnViewJuz" class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium transition">ğŸ“š Per Juz</button>
            </div>
            <div class="mb-4"><input type="text" id="searchSurah" oninput="filterSurahList()" class="w-full border border-gray-300 rounded-lg px-4 py-2.5" placeholder="ğŸ” Cari nama surat..."></div>
            <div id="quranSurahView"><div class="grid grid-cols-1 md:grid-cols-2 gap-2" id="surahListContainer"></div></div>
            <div id="quranJuzView" class="hidden"><div class="grid grid-cols-2 md:grid-cols-5 gap-3" id="juzListContainer"></div></div>
        </div>
    </div>
</div>

<!-- Surah Reader Modal -->
<div id="surahModal" class="modal-overlay" onclick="if(event.target===this)closeSurahModal()">
    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[95vh] overflow-y-auto m-4">
        <div class="bg-islamic text-white p-5 rounded-t-2xl sticky top-0 z-10">
            <div class="flex justify-between items-center">
                <div><h3 id="rdSurahName" class="text-lg font-bold gold-text"></h3><p id="rdSurahInfo" class="text-emerald-200 text-xs"></p></div>
                <div class="flex items-center gap-2">
                    <button onclick="prevSurah()" class="bg-emerald-700 hover:bg-emerald-600 px-3 py-1 rounded text-sm">â—€</button>
                    <button onclick="nextSurah()" class="bg-emerald-700 hover:bg-emerald-600 px-3 py-1 rounded text-sm">â–¶</button>
                    <button onclick="closeSurahModal()" class="text-white hover:text-red-300 text-2xl ml-2">&times;</button>
                </div>
            </div>
        </div>
        <div class="p-5" id="rdSurahBody"><div class="text-center py-10 text-gray-400">Memuat...</div></div>
    </div>
</div>

<!-- ==================== HAFALAN SHALAT ==================== -->
<div id="tab-shalat" class="tab-content fade-in">
    <div class="container mx-auto px-4 py-6 max-w-4xl">
        <div class="bg-white rounded-2xl shadow-lg p-6">
            <h3 class="text-xl font-bold text-emerald-800 mb-2">ğŸ•Œ Hafalan Bacaan Shalat</h3>
            <p class="text-sm text-gray-500 mb-5">Panduan bacaan shalat lengkap beserta artinya</p>
            <div class="flex overflow-x-auto gap-2 mb-5 pb-2" id="shalatNav"></div>
            <div id="shalatContent"></div>
        </div>
    </div>
</div>

<!-- ==================== DOA-DOA ==================== -->
<div id="tab-doa" class="tab-content fade-in">
    <div class="container mx-auto px-4 py-6 max-w-4xl">
        <div class="bg-white rounded-2xl shadow-lg p-6">
            <h3 class="text-xl font-bold text-emerald-800 mb-2">ğŸ¤² Kumpulan Doa-Doa</h3>
            <p class="text-sm text-gray-500 mb-4">Doa harian dan doa khusus Ramadhan</p>
            <div class="flex gap-2 mb-5 overflow-x-auto pb-2" id="doaNav"></div>
            <div id="doaContent"></div>
        </div>
    </div>
</div>

<!-- ==================== DATA AMALIAH ==================== -->
<div id="tab-data" class="tab-content fade-in">
    <div class="container mx-auto px-4 py-6 max-w-6xl">
        <div class="bg-white rounded-2xl shadow-lg p-6">
            <h3 class="text-xl font-bold text-emerald-800 mb-4">ğŸ“Š Data Amaliah Siswa</h3>
            <div class="flex flex-wrap gap-3 mb-4">
                <button onclick="loadAmaliahData()" class="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-lg text-sm">ğŸ”„ Muat Data</button>
                <input type="text" id="searchData" placeholder="ğŸ” Cari nama..." class="border border-gray-300 rounded-lg px-4 py-2 text-sm flex-1 min-w-48" oninput="filterAmaliahData()">
                <select id="filterKelas" onchange="filterAmaliahData()" class="border border-gray-300 rounded-lg px-3 py-2 text-sm"><option value="">Semua Kelas</option></select>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full text-xs md:text-sm">
                    <thead><tr class="bg-emerald-700 text-white"><th class="px-2 py-2">No</th><th class="px-2 py-2">Nama</th><th class="px-2 py-2">Kelas</th><th class="px-2 py-2">Tanggal</th><th class="px-2 py-2">Hari</th><th class="px-2 py-2">Shalat</th><th class="px-2 py-2">Sunnah</th><th class="px-2 py-2">Puasa</th><th class="px-2 py-2">Tadarus</th><th class="px-2 py-2">Hafalan</th></tr></thead>
                    <tbody id="dataBody"><tr><td colspan="10" class="text-center py-8 text-gray-400">Klik "Muat Data"</td></tr></tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- ==================== PROGRESS ==================== -->
<div id="tab-progress" class="tab-content fade-in">
    <div class="container mx-auto px-4 py-6 max-w-4xl">
        <div class="bg-white rounded-2xl shadow-lg p-6">
            <h3 class="text-xl font-bold text-emerald-800 mb-4">ğŸ“ˆ Progress Ibadah Saya</h3>
            <div id="progressContent"><p class="text-gray-400 text-center py-8">Klik tombol di bawah untuk memuat progress</p></div>
            <button onclick="loadMyProgress()" class="mt-4 bg-emerald-600 hover:bg-emerald-700 text-white px-6 py-2 rounded-lg text-sm">ğŸ”„ Muat Progress</button>
        </div>
    </div>
</div>

<!-- ==================== KELOLA USER ==================== -->
<div id="tab-users" class="tab-content fade-in">
    <div class="container mx-auto px-4 py-6 max-w-6xl">
        <div class="bg-white rounded-2xl shadow-lg p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-emerald-800">ğŸ‘¥ Kelola Pengguna</h3>
                <button onclick="showAddUserForm()" class="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-lg text-sm">â• Tambah User</button>
            </div>
            <div id="addUserForm" class="hidden bg-emerald-50 rounded-xl p-5 mb-5 border border-emerald-200">
                <h4 class="font-semibold text-emerald-800 mb-3">Tambah Pengguna Baru</h4>
                <div class="grid md:grid-cols-2 gap-3 mb-3">
                    <input type="text" id="newUsername" placeholder="NIS/Username" class="border rounded-lg px-3 py-2 text-sm">
                    <input type="password" id="newPassword" placeholder="Password" class="border rounded-lg px-3 py-2 text-sm">
                    <input type="text" id="newNama" placeholder="Nama Lengkap" class="border rounded-lg px-3 py-2 text-sm">
                    <select id="newRole" class="border rounded-lg px-3 py-2 text-sm"><option value="siswa">Siswa</option><option value="guru">Guru PAI</option><option value="wali">Wali Kelas</option><option value="admin">Admin</option></select>
                    <input type="text" id="newKelas" placeholder="Kelas (cth: 10-A)" class="border rounded-lg px-3 py-2 text-sm">
                </div>
                <div class="flex gap-2">
                    <button onclick="addUser()" class="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-lg text-sm">ğŸ’¾ Simpan</button>
                    <button onclick="document.getElementById('addUserForm').classList.add('hidden')" class="bg-gray-200 px-4 py-2 rounded-lg text-sm">Batal</button>
                </div>
            </div>
            <div class="flex gap-3 mb-4">
                <button onclick="loadUsers()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm">ğŸ”„ Muat User</button>
                <select id="filterUserRole" onchange="filterUsers()" class="border rounded-lg px-3 py-2 text-sm"><option value="">Semua Role</option><option value="siswa">Siswa</option><option value="guru">Guru PAI</option><option value="wali">Wali Kelas</option><option value="admin">Admin</option></select>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full text-sm"><thead><tr class="bg-emerald-700 text-white"><th class="px-3 py-2">No</th><th class="px-3 py-2">Username/NIS</th><th class="px-3 py-2">Nama</th><th class="px-3 py-2">Role</th><th class="px-3 py-2">Kelas</th><th class="px-3 py-2">Aksi</th></tr></thead>
                <tbody id="userBody"><tr><td colspan="6" class="text-center py-8 text-gray-400">Klik "Muat User"</td></tr></tbody></table>
            </div>
        </div>
    </div>
</div>

<!-- ==================== SETUP ==================== -->
<div id="tab-setup" class="tab-content fade-in">
    <div class="container mx-auto px-4 py-6 max-w-4xl">
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-6 border-2 border-emerald-300">
            <div class="flex items-center gap-3 mb-4">
                <div class="bg-emerald-600 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold text-lg">1</div>
                <div><h3 class="text-xl font-bold text-emerald-800">ğŸ“Š Masukkan Spreadsheet ID</h3><p class="text-sm text-gray-500">ID otomatis tertanam di kode GAS</p></div>
            </div>
            <div class="bg-amber-50 border-l-4 border-amber-500 p-4 mb-4 rounded"><p class="text-sm text-amber-800"><strong>âš ï¸ Penting!</strong> Spreadsheet ID langsung masuk ke kode GAS. Tinggal copy-paste!</p></div>
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ”‘ Spreadsheet ID</label>
                <input type="text" id="spreadsheetId" oninput="onSpreadsheetIdChange()" class="w-full border-2 border-emerald-400 rounded-xl px-4 py-3 font-mono text-base focus:ring-4 focus:ring-emerald-200 focus:border-emerald-600 bg-emerald-50" placeholder="Paste Spreadsheet ID di sini...">
            </div>
            <div id="idStatus" class="mb-4"></div>
            <details class="bg-blue-50 border border-blue-200 rounded-xl p-4">
                <summary class="font-semibold text-blue-800 text-sm cursor-pointer">ğŸ“Œ Cara Mendapatkan Spreadsheet ID</summary>
                <ol class="text-sm text-blue-700 space-y-2 mt-3 list-decimal list-inside">
                    <li>Buka <a href="https://sheets.google.com" target="_blank" class="underline font-semibold">Google Spreadsheet</a> â†’ buat baru</li>
                    <li>Lihat URL: <code class="bg-blue-100 px-2 py-1 rounded text-xs break-all">https://docs.google.com/spreadsheets/d/<b class="text-red-600">ID_ANDA</b>/edit</code></li>
                    <li>Copy bagian <b class="text-red-600">merah</b> â†’ paste di atas</li>
                </ol>
            </details>
        </div>
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-6 border-2 border-amber-300">
            <div class="flex items-center gap-3 mb-4">
                <div class="bg-amber-500 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold text-lg">2</div>
                <div><h3 class="text-xl font-bold text-emerald-800">ğŸ“ Copy Kode GAS (ID Tertanam)</h3><p class="text-sm text-gray-500">Kode sudah berisi Spreadsheet ID â€” tinggal copy & paste</p></div>
            </div>
            <div class="bg-gray-800 text-white rounded-xl p-4 mb-4 font-mono text-sm">
                <p class="text-gray-400 text-xs mb-1">// Di dalam kode GAS:</p>
                <p>const SPREADSHEET_ID = '<span id="previewId" class="text-yellow-300 font-bold">BELUM_DIISI</span>';</p>
            </div>
            <div class="flex flex-wrap gap-3 mb-4">
                <button onclick="copyGasCode()" class="bg-emerald-600 hover:bg-emerald-700 text-white px-6 py-3 rounded-xl text-sm font-bold shadow-lg transition flex items-center gap-2 pulse-glow">ğŸ“‹ COPY KODE GAS LENGKAP</button>
                <button onclick="toggleCodeView()" id="btnToggleCode" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-3 rounded-xl text-sm font-medium">ğŸ‘ï¸ Lihat Kode</button>
            </div>
            <div id="gasCodeContainer" class="hidden"><pre class="bg-gray-900 text-green-400 p-4 rounded-xl text-xs overflow-x-auto leading-relaxed max-h-[500px] overflow-y-auto" id="gasCode"></pre></div>
            <div class="bg-green-50 border border-green-200 rounded-xl p-4 mt-4">
                <h4 class="font-semibold text-green-800 text-sm mb-2">ğŸ“‹ Cara Paste ke Apps Script:</h4>
                <ol class="text-sm text-green-700 space-y-1.5 list-decimal list-inside">
                    <li>Buka Spreadsheet â†’ <strong>Extensions â†’ Apps Script</strong></li>
                    <li>Hapus kode default</li>
                    <li>Klik <strong>"ğŸ“‹ COPY KODE GAS"</strong> di atas â†’ <strong>Paste</strong> (Ctrl+V)</li>
                    <li>Klik <strong>ğŸ’¾ Save</strong> (Ctrl+S)</li>
                </ol>
            </div>
        </div>
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-6 border-2 border-blue-300">
            <div class="flex items-center gap-3 mb-4">
                <div class="bg-blue-600 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold text-lg">3</div>
                <div><h3 class="text-xl font-bold text-emerald-800">ğŸš€ Deploy & Hubungkan</h3><p class="text-sm text-gray-500">Deploy Apps Script lalu paste URL-nya</p></div>
            </div>
            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-4 rounded">
                <ol class="text-sm text-blue-700 space-y-1 list-decimal list-inside">
                    <li>Di Apps Script: <strong>Deploy â†’ New Deployment â†’ Web app</strong></li>
                    <li>Execute as: <strong>Me</strong> | Access: <strong>Anyone</strong></li>
                    <li>Klik <strong>Deploy</strong> â†’ <strong>Authorize</strong> â†’ Allow</li>
                    <li>Copy <strong>URL Web App</strong></li>
                </ol>
            </div>
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ”— URL Web App</label>
                <input type="text" id="gasUrl" class="w-full border-2 border-blue-400 rounded-xl px-4 py-3 font-mono text-sm focus:ring-4 focus:ring-blue-200" placeholder="https://script.google.com/macros/s/xxxxx/exec">
            </div>
            <div class="flex flex-wrap gap-3">
                <button onclick="saveSetup()" class="bg-emerald-600 hover:bg-emerald-700 text-white px-5 py-2.5 rounded-lg text-sm font-medium">ğŸ’¾ Simpan</button>
                <button onclick="testConnection()" class="bg-blue-600 hover:bg-blue-700 text-white px-5 py-2.5 rounded-lg text-sm font-medium">ğŸ”Œ Test Koneksi</button>
                <button onclick="initSheets()" class="bg-purple-600 hover:bg-purple-700 text-white px-5 py-2.5 rounded-lg text-sm font-medium">ğŸ—„ï¸ Init Database</button>
            </div>
            <p id="connectionStatus" class="mt-3 text-sm"></p>
        </div>
        <div class="bg-white rounded-2xl shadow-lg p-6 border-2 border-purple-300">
            <div class="flex items-center gap-3 mb-4">
                <div class="bg-purple-600 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold text-lg">4</div>
                <div><h3 class="text-xl font-bold text-emerald-800">ğŸ—„ï¸ Struktur Database (3 Sheet)</h3></div>
            </div>
            <div class="grid md:grid-cols-3 gap-4">
                <div class="bg-emerald-50 rounded-xl p-4 border border-emerald-200">
                    <h4 class="font-semibold text-emerald-800 mb-2">ğŸ“‹ Sheet: Users</h4>
                    <div class="text-xs text-gray-600 space-y-0.5"><p>â€¢ Username/NIS</p><p>â€¢ Password</p><p>â€¢ Nama, Role, Kelas, Status</p></div>
                </div>
                <div class="bg-amber-50 rounded-xl p-4 border border-amber-200">
                    <h4 class="font-semibold text-amber-800 mb-2">ğŸ“‹ Sheet: DataAmaliah</h4>
                    <div class="text-xs text-gray-600 space-y-0.5"><p>â€¢ Timestamp, Username, Nama, Kelas</p><p>â€¢ Shalat 5 Waktu, Sunnah</p><p>â€¢ Tadarus, Hafalan, Catatan</p></div>
                </div>
                <div class="bg-blue-50 rounded-xl p-4 border border-blue-200">
                    <h4 class="font-semibold text-blue-800 mb-2">ğŸ“‹ Sheet: SetorHafalan</h4>
                    <div class="text-xs text-gray-600 space-y-0.5"><p>â€¢ Timestamp, Username, Nama, Kelas</p><p>â€¢ Surat, DariAyat, SampaiAyat</p><p>â€¢ Status, Nilai, CatatanGuru</p></div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- FOOTER -->
<footer class="bg-emerald-900 text-white py-6 mt-8">
    <div class="container mx-auto px-4 text-center">
        <div class="arabic text-xl gold-text mb-2">Ø±ÙØ¨ÙÙ‘Ù†ÙØ§ ØªÙÙ‚ÙØ¨ÙÙ‘Ù„Ù’ Ù…ÙÙ†ÙÙ‘Ø§ Ø¥ÙÙ†ÙÙ‘ÙƒÙ Ø£ÙÙ†Ù’ØªÙ Ø§Ù„Ø³ÙÙ‘Ù…ÙÙŠØ¹Ù Ø§Ù„Ù’Ø¹ÙÙ„ÙÙŠÙ…Ù</div>
        <p class="text-emerald-300 text-sm mb-1">"Ya Tuhan kami, terimalah amal dari kami. Engkaulah Yang Maha Mendengar, Maha Mengetahui."</p>
        <p class="text-emerald-400 text-xs mt-3">Â© 2026 Amaliah Ramadhan 1447 H â€” SMAN 10 Pinrang</p>
        <p class="text-emerald-300 text-xs mt-1.5 font-medium">ğŸ’» Dikembangkan oleh <span class="gold-text font-bold">Murdani</span> â€” 2026</p>
    </div>
</footer>
</div>

<button onclick="window.scrollTo({top:0,behavior:'smooth'})" class="fixed bottom-5 right-5 z-50 bg-emerald-600 hover:bg-emerald-700 text-white w-11 h-11 rounded-full shadow-lg flex items-center justify-center text-lg transition">â†‘</button>

<script>
// ==================== DATA ====================
const DEFAULT_ACCOUNTS=[
    {username:'admin',password:'admin123',nama:'Administrator',role:'admin',kelas:'-'},
    {username:'gurupai',password:'guru123',nama:'Ustadz Ibrahim',role:'guru',kelas:'-'},
    {username:'gurupai2',password:'guru123',nama:'Ustadzah Maryam',role:'guru',kelas:'-'},
    {username:'wali10a',password:'wali123',nama:'Pak Ahmad S.Pd',role:'wali',kelas:'10-A'},
    {username:'wali10b',password:'wali123',nama:'Ibu Fatimah S.Pd',role:'wali',kelas:'10-B'},
    {username:'wali11a',password:'wali123',nama:'Pak Hasan M.Pd',role:'wali',kelas:'11-A'},
    {username:'10001',password:'siswa123',nama:'Muhammad Rizki',role:'siswa',kelas:'10-A'},
    {username:'10002',password:'siswa123',nama:'Aisyah Putri',role:'siswa',kelas:'10-A'},
    {username:'10003',password:'siswa123',nama:'Abdullah Faqih',role:'siswa',kelas:'10-B'},
    {username:'10004',password:'siswa123',nama:'Khadijah Zahra',role:'siswa',kelas:'11-A'},
];

const ROLE_LABELS={siswa:'ğŸ‘¨â€ğŸ“ Siswa',guru:'ğŸ‘¨â€ğŸ« Guru PAI',wali:'ğŸ‘©â€ğŸ« Wali Kelas',admin:'ğŸ‘¨â€ğŸ’¼ Admin'};
const ROLE_AVATARS={siswa:'ğŸ‘¨â€ğŸ“',guru:'ğŸ‘¨â€ğŸ«',wali:'ğŸ‘©â€ğŸ«',admin:'ğŸ‘¨â€ğŸ’¼'};

const NAV_ITEMS={
    siswa:[{id:'beranda',icon:'ğŸ ',label:'Beranda'},{id:'amaliah',icon:'âœ…',label:'Amaliah'},{id:'hafalan',icon:'ğŸ“—',label:'Setor Hafalan'},{id:'quran',icon:'ğŸ“–',label:'Al-Quran'},{id:'shalat',icon:'ğŸ•Œ',label:'Shalat'},{id:'doa',icon:'ğŸ¤²',label:'Doa'},{id:'progress',icon:'ğŸ“ˆ',label:'Progress'}],
    guru:[{id:'beranda',icon:'ğŸ ',label:'Beranda'},{id:'datahafalan',icon:'ğŸ“—',label:'Hafalan Siswa'},{id:'data',icon:'ğŸ“Š',label:'Data Amaliah'},{id:'quran',icon:'ğŸ“–',label:'Al-Quran'},{id:'shalat',icon:'ğŸ•Œ',label:'Shalat'},{id:'doa',icon:'ğŸ¤²',label:'Doa'}],
    wali:[{id:'beranda',icon:'ğŸ ',label:'Beranda'},{id:'data',icon:'ğŸ“Š',label:'Data Siswa'},{id:'datahafalan',icon:'ğŸ“—',label:'Hafalan'},{id:'quran',icon:'ğŸ“–',label:'Al-Quran'},{id:'shalat',icon:'ğŸ•Œ',label:'Shalat'},{id:'doa',icon:'ğŸ¤²',label:'Doa'}],
    admin:[{id:'beranda',icon:'ğŸ ',label:'Beranda'},{id:'data',icon:'ğŸ“Š',label:'Data Amaliah'},{id:'datahafalan',icon:'ğŸ“—',label:'Hafalan'},{id:'users',icon:'ğŸ‘¥',label:'Kelola User'},{id:'quran',icon:'ğŸ“–',label:'Al-Quran'},{id:'shalat',icon:'ğŸ•Œ',label:'Shalat'},{id:'doa',icon:'ğŸ¤²',label:'Doa'},{id:'setup',icon:'âš™ï¸',label:'Setup'}]
};

const ALL_SURAHS=[{no:1,name:"Al-Fatihah",ar:"Ø§Ù„ÙØ§ØªØ­Ø©",arti:"Pembukaan",ayat:7,type:"Makkiyah",juz:1},{no:2,name:"Al-Baqarah",ar:"Ø§Ù„Ø¨Ù‚Ø±Ø©",arti:"Sapi",ayat:286,type:"Madaniyah",juz:1},{no:3,name:"Ali 'Imran",ar:"Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†",arti:"Keluarga Imran",ayat:200,type:"Madaniyah",juz:3},{no:4,name:"An-Nisa'",ar:"Ø§Ù„Ù†Ø³Ø§Ø¡",arti:"Wanita",ayat:176,type:"Madaniyah",juz:4},{no:5,name:"Al-Ma'idah",ar:"Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©",arti:"Hidangan",ayat:120,type:"Madaniyah",juz:6},{no:6,name:"Al-An'am",ar:"Ø§Ù„Ø£Ù†Ø¹Ø§Ù…",arti:"Binatang Ternak",ayat:165,type:"Makkiyah",juz:7},{no:7,name:"Al-A'raf",ar:"Ø§Ù„Ø£Ø¹Ø±Ø§Ù",arti:"Tempat Tertinggi",ayat:206,type:"Makkiyah",juz:8},{no:8,name:"Al-Anfal",ar:"Ø§Ù„Ø£Ù†ÙØ§Ù„",arti:"Rampasan Perang",ayat:75,type:"Madaniyah",juz:9},{no:9,name:"At-Taubah",ar:"Ø§Ù„ØªÙˆØ¨Ø©",arti:"Pengampunan",ayat:129,type:"Madaniyah",juz:10},{no:10,name:"Yunus",ar:"ÙŠÙˆÙ†Ø³",arti:"Yunus",ayat:109,type:"Makkiyah",juz:11},{no:11,name:"Hud",ar:"Ù‡ÙˆØ¯",arti:"Hud",ayat:123,type:"Makkiyah",juz:11},{no:12,name:"Yusuf",ar:"ÙŠÙˆØ³Ù",arti:"Yusuf",ayat:111,type:"Makkiyah",juz:12},{no:13,name:"Ar-Ra'd",ar:"Ø§Ù„Ø±Ø¹Ø¯",arti:"Guruh",ayat:43,type:"Madaniyah",juz:13},{no:14,name:"Ibrahim",ar:"Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…",arti:"Ibrahim",ayat:52,type:"Makkiyah",juz:13},{no:15,name:"Al-Hijr",ar:"Ø§Ù„Ø­Ø¬Ø±",arti:"Hijr",ayat:99,type:"Makkiyah",juz:14},{no:16,name:"An-Nahl",ar:"Ø§Ù„Ù†Ø­Ù„",arti:"Lebah",ayat:128,type:"Makkiyah",juz:14},{no:17,name:"Al-Isra'",ar:"Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡",arti:"Perjalanan Malam",ayat:111,type:"Makkiyah",juz:15},{no:18,name:"Al-Kahf",ar:"Ø§Ù„ÙƒÙ‡Ù",arti:"Gua",ayat:110,type:"Makkiyah",juz:15},{no:19,name:"Maryam",ar:"Ù…Ø±ÙŠÙ…",arti:"Maryam",ayat:98,type:"Makkiyah",juz:16},{no:20,name:"Taha",ar:"Ø·Ù‡",arti:"Taha",ayat:135,type:"Makkiyah",juz:16},{no:21,name:"Al-Anbiya'",ar:"Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡",arti:"Para Nabi",ayat:112,type:"Makkiyah",juz:17},{no:22,name:"Al-Hajj",ar:"Ø§Ù„Ø­Ø¬",arti:"Haji",ayat:78,type:"Madaniyah",juz:17},{no:23,name:"Al-Mu'minun",ar:"Ø§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ†",arti:"Orang Beriman",ayat:118,type:"Makkiyah",juz:18},{no:24,name:"An-Nur",ar:"Ø§Ù„Ù†ÙˆØ±",arti:"Cahaya",ayat:64,type:"Madaniyah",juz:18},{no:25,name:"Al-Furqan",ar:"Ø§Ù„ÙØ±Ù‚Ø§Ù†",arti:"Pembeda",ayat:77,type:"Makkiyah",juz:18},{no:26,name:"Asy-Syu'ara'",ar:"Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡",arti:"Para Penyair",ayat:227,type:"Makkiyah",juz:19},{no:27,name:"An-Naml",ar:"Ø§Ù„Ù†Ù…Ù„",arti:"Semut",ayat:93,type:"Makkiyah",juz:19},{no:28,name:"Al-Qasas",ar:"Ø§Ù„Ù‚ØµØµ",arti:"Kisah-Kisah",ayat:88,type:"Makkiyah",juz:20},{no:29,name:"Al-'Ankabut",ar:"Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª",arti:"Laba-Laba",ayat:69,type:"Makkiyah",juz:20},{no:30,name:"Ar-Rum",ar:"Ø§Ù„Ø±ÙˆÙ…",arti:"Romawi",ayat:60,type:"Makkiyah",juz:21},{no:31,name:"Luqman",ar:"Ù„Ù‚Ù…Ø§Ù†",arti:"Luqman",ayat:34,type:"Makkiyah",juz:21},{no:32,name:"As-Sajdah",ar:"Ø§Ù„Ø³Ø¬Ø¯Ø©",arti:"Sujud",ayat:30,type:"Makkiyah",juz:21},{no:33,name:"Al-Ahzab",ar:"Ø§Ù„Ø£Ø­Ø²Ø§Ø¨",arti:"Golongan",ayat:73,type:"Madaniyah",juz:21},{no:34,name:"Saba'",ar:"Ø³Ø¨Ø£",arti:"Saba'",ayat:54,type:"Makkiyah",juz:22},{no:35,name:"Fatir",ar:"ÙØ§Ø·Ø±",arti:"Pencipta",ayat:45,type:"Makkiyah",juz:22},{no:36,name:"Ya-Sin",ar:"ÙŠØ³",arti:"Ya Sin",ayat:83,type:"Makkiyah",juz:22},{no:37,name:"As-Saffat",ar:"Ø§Ù„ØµØ§ÙØ§Øª",arti:"Yang Berbaris",ayat:182,type:"Makkiyah",juz:23},{no:38,name:"Sad",ar:"Øµ",arti:"Sad",ayat:88,type:"Makkiyah",juz:23},{no:39,name:"Az-Zumar",ar:"Ø§Ù„Ø²Ù…Ø±",arti:"Rombongan",ayat:75,type:"Makkiyah",juz:23},{no:40,name:"Ghafir",ar:"ØºØ§ÙØ±",arti:"Yang Mengampuni",ayat:85,type:"Makkiyah",juz:24},{no:41,name:"Fussilat",ar:"ÙØµÙ„Øª",arti:"Yang Dijelaskan",ayat:54,type:"Makkiyah",juz:24},{no:42,name:"Asy-Syura",ar:"Ø§Ù„Ø´ÙˆØ±Ù‰",arti:"Musyawarah",ayat:53,type:"Makkiyah",juz:25},{no:43,name:"Az-Zukhruf",ar:"Ø§Ù„Ø²Ø®Ø±Ù",arti:"Perhiasan",ayat:89,type:"Makkiyah",juz:25},{no:44,name:"Ad-Dukhan",ar:"Ø§Ù„Ø¯Ø®Ø§Ù†",arti:"Kabut",ayat:59,type:"Makkiyah",juz:25},{no:45,name:"Al-Jasiyah",ar:"Ø§Ù„Ø¬Ø§Ø«ÙŠØ©",arti:"Yang Berlutut",ayat:37,type:"Makkiyah",juz:25},{no:46,name:"Al-Ahqaf",ar:"Ø§Ù„Ø£Ø­Ù‚Ø§Ù",arti:"Bukit Pasir",ayat:35,type:"Makkiyah",juz:26},{no:47,name:"Muhammad",ar:"Ù…Ø­Ù…Ø¯",arti:"Muhammad",ayat:38,type:"Madaniyah",juz:26},{no:48,name:"Al-Fath",ar:"Ø§Ù„ÙØªØ­",arti:"Kemenangan",ayat:29,type:"Madaniyah",juz:26},{no:49,name:"Al-Hujurat",ar:"Ø§Ù„Ø­Ø¬Ø±Ø§Øª",arti:"Kamar-Kamar",ayat:18,type:"Madaniyah",juz:26},{no:50,name:"Qaf",ar:"Ù‚",arti:"Qaf",ayat:45,type:"Makkiyah",juz:26},{no:51,name:"Adz-Dzariyat",ar:"Ø§Ù„Ø°Ø§Ø±ÙŠØ§Øª",arti:"Angin yang Menerbangkan",ayat:60,type:"Makkiyah",juz:26},{no:52,name:"At-Tur",ar:"Ø§Ù„Ø·ÙˆØ±",arti:"Bukit Tur",ayat:49,type:"Makkiyah",juz:27},{no:53,name:"An-Najm",ar:"Ø§Ù„Ù†Ø¬Ù…",arti:"Bintang",ayat:62,type:"Makkiyah",juz:27},{no:54,name:"Al-Qamar",ar:"Ø§Ù„Ù‚Ù…Ø±",arti:"Bulan",ayat:55,type:"Makkiyah",juz:27},{no:55,name:"Ar-Rahman",ar:"Ø§Ù„Ø±Ø­Ù…Ù†",arti:"Yang Maha Pengasih",ayat:78,type:"Madaniyah",juz:27},{no:56,name:"Al-Waqi'ah",ar:"Ø§Ù„ÙˆØ§Ù‚Ø¹Ø©",arti:"Hari Kiamat",ayat:96,type:"Makkiyah",juz:27},{no:57,name:"Al-Hadid",ar:"Ø§Ù„Ø­Ø¯ÙŠØ¯",arti:"Besi",ayat:29,type:"Madaniyah",juz:27},{no:58,name:"Al-Mujadalah",ar:"Ø§Ù„Ù…Ø¬Ø§Ø¯Ù„Ø©",arti:"Gugatan",ayat:22,type:"Madaniyah",juz:28},{no:59,name:"Al-Hasyr",ar:"Ø§Ù„Ø­Ø´Ø±",arti:"Pengusiran",ayat:24,type:"Madaniyah",juz:28},{no:60,name:"Al-Mumtahanah",ar:"Ø§Ù„Ù…Ù…ØªØ­Ù†Ø©",arti:"Wanita yang Diuji",ayat:13,type:"Madaniyah",juz:28},{no:61,name:"As-Saff",ar:"Ø§Ù„ØµÙ",arti:"Barisan",ayat:14,type:"Madaniyah",juz:28},{no:62,name:"Al-Jumu'ah",ar:"Ø§Ù„Ø¬Ù…Ø¹Ø©",arti:"Jumat",ayat:11,type:"Madaniyah",juz:28},{no:63,name:"Al-Munafiqun",ar:"Ø§Ù„Ù…Ù†Ø§ÙÙ‚ÙˆÙ†",arti:"Orang Munafik",ayat:11,type:"Madaniyah",juz:28},{no:64,name:"At-Taghabun",ar:"Ø§Ù„ØªØºØ§Ø¨Ù†",arti:"Pengungkapan Kesalahan",ayat:18,type:"Madaniyah",juz:28},{no:65,name:"At-Talaq",ar:"Ø§Ù„Ø·Ù„Ø§Ù‚",arti:"Talak",ayat:12,type:"Madaniyah",juz:28},{no:66,name:"At-Tahrim",ar:"Ø§Ù„ØªØ­Ø±ÙŠÙ…",arti:"Pengharaman",ayat:12,type:"Madaniyah",juz:28},{no:67,name:"Al-Mulk",ar:"Ø§Ù„Ù…Ù„Ùƒ",arti:"Kerajaan",ayat:30,type:"Makkiyah",juz:29},{no:68,name:"Al-Qalam",ar:"Ø§Ù„Ù‚Ù„Ù…",arti:"Pena",ayat:52,type:"Makkiyah",juz:29},{no:69,name:"Al-Haqqah",ar:"Ø§Ù„Ø­Ø§Ù‚Ø©",arti:"Hari Kiamat",ayat:52,type:"Makkiyah",juz:29},{no:70,name:"Al-Ma'arij",ar:"Ø§Ù„Ù…Ø¹Ø§Ø±Ø¬",arti:"Tempat Naik",ayat:44,type:"Makkiyah",juz:29},{no:71,name:"Nuh",ar:"Ù†ÙˆØ­",arti:"Nuh",ayat:28,type:"Makkiyah",juz:29},{no:72,name:"Al-Jinn",ar:"Ø§Ù„Ø¬Ù†",arti:"Jin",ayat:28,type:"Makkiyah",juz:29},{no:73,name:"Al-Muzzammil",ar:"Ø§Ù„Ù…Ø²Ù…Ù„",arti:"Orang yang Berselimut",ayat:20,type:"Makkiyah",juz:29},{no:74,name:"Al-Muddassir",ar:"Ø§Ù„Ù…Ø¯Ø«Ø±",arti:"Orang yang Berkemul",ayat:56,type:"Makkiyah",juz:29},{no:75,name:"Al-Qiyamah",ar:"Ø§Ù„Ù‚ÙŠØ§Ù…Ø©",arti:"Hari Kiamat",ayat:40,type:"Makkiyah",juz:29},{no:76,name:"Al-Insan",ar:"Ø§Ù„Ø¥Ù†Ø³Ø§Ù†",arti:"Manusia",ayat:31,type:"Madaniyah",juz:29},{no:77,name:"Al-Mursalat",ar:"Ø§Ù„Ù…Ø±Ø³Ù„Ø§Øª",arti:"Malaikat yang Diutus",ayat:50,type:"Makkiyah",juz:29},{no:78,name:"An-Naba'",ar:"Ø§Ù„Ù†Ø¨Ø£",arti:"Berita Besar",ayat:40,type:"Makkiyah",juz:30},{no:79,name:"An-Nazi'at",ar:"Ø§Ù„Ù†Ø§Ø²Ø¹Ø§Øª",arti:"Malaikat Pencabut Nyawa",ayat:46,type:"Makkiyah",juz:30},{no:80,name:"'Abasa",ar:"Ø¹Ø¨Ø³",arti:"Bermuka Masam",ayat:42,type:"Makkiyah",juz:30},{no:81,name:"At-Takwir",ar:"Ø§Ù„ØªÙƒÙˆÙŠØ±",arti:"Menggulung",ayat:29,type:"Makkiyah",juz:30},{no:82,name:"Al-Infitar",ar:"Ø§Ù„Ø§Ù†ÙØ·Ø§Ø±",arti:"Terbelah",ayat:19,type:"Makkiyah",juz:30},{no:83,name:"Al-Mutaffifin",ar:"Ø§Ù„Ù…Ø·ÙÙÙŠÙ†",arti:"Orang yang Curang",ayat:36,type:"Makkiyah",juz:30},{no:84,name:"Al-Insyiqaq",ar:"Ø§Ù„Ø§Ù†Ø´Ù‚Ø§Ù‚",arti:"Terbelah",ayat:25,type:"Makkiyah",juz:30},{no:85,name:"Al-Buruj",ar:"Ø§Ù„Ø¨Ø±ÙˆØ¬",arti:"Gugusan Bintang",ayat:22,type:"Makkiyah",juz:30},{no:86,name:"At-Tariq",ar:"Ø§Ù„Ø·Ø§Ø±Ù‚",arti:"Yang Datang di Malam Hari",ayat:17,type:"Makkiyah",juz:30},{no:87,name:"Al-A'la",ar:"Ø§Ù„Ø£Ø¹Ù„Ù‰",arti:"Yang Paling Tinggi",ayat:19,type:"Makkiyah",juz:30},{no:88,name:"Al-Gasyiyah",ar:"Ø§Ù„ØºØ§Ø´ÙŠØ©",arti:"Hari Pembalasan",ayat:26,type:"Makkiyah",juz:30},{no:89,name:"Al-Fajr",ar:"Ø§Ù„ÙØ¬Ø±",arti:"Fajar",ayat:30,type:"Makkiyah",juz:30},{no:90,name:"Al-Balad",ar:"Ø§Ù„Ø¨Ù„Ø¯",arti:"Negeri",ayat:20,type:"Makkiyah",juz:30},{no:91,name:"Asy-Syams",ar:"Ø§Ù„Ø´Ù…Ø³",arti:"Matahari",ayat:15,type:"Makkiyah",juz:30},{no:92,name:"Al-Lail",ar:"Ø§Ù„Ù„ÙŠÙ„",arti:"Malam",ayat:21,type:"Makkiyah",juz:30},{no:93,name:"Ad-Duha",ar:"Ø§Ù„Ø¶Ø­Ù‰",arti:"Waktu Duha",ayat:11,type:"Makkiyah",juz:30},{no:94,name:"Al-Insyirah",ar:"Ø§Ù„Ø´Ø±Ø­",arti:"Kelapangan",ayat:8,type:"Makkiyah",juz:30},{no:95,name:"At-Tin",ar:"Ø§Ù„ØªÙŠÙ†",arti:"Buah Tin",ayat:8,type:"Makkiyah",juz:30},{no:96,name:"Al-'Alaq",ar:"Ø§Ù„Ø¹Ù„Ù‚",arti:"Segumpal Darah",ayat:19,type:"Makkiyah",juz:30},{no:97,name:"Al-Qadr",ar:"Ø§Ù„Ù‚Ø¯Ø±",arti:"Kemuliaan",ayat:5,type:"Makkiyah",juz:30},{no:98,name:"Al-Bayyinah",ar:"Ø§Ù„Ø¨ÙŠÙ†Ø©",arti:"Bukti Nyata",ayat:8,type:"Madaniyah",juz:30},{no:99,name:"Az-Zalzalah",ar:"Ø§Ù„Ø²Ù„Ø²Ù„Ø©",arti:"Kegoncangan",ayat:8,type:"Madaniyah",juz:30},{no:100,name:"Al-'Adiyat",ar:"Ø§Ù„Ø¹Ø§Ø¯ÙŠØ§Øª",arti:"Kuda Perang",ayat:11,type:"Makkiyah",juz:30},{no:101,name:"Al-Qari'ah",ar:"Ø§Ù„Ù‚Ø§Ø±Ø¹Ø©",arti:"Hari Kiamat",ayat:11,type:"Makkiyah",juz:30},{no:102,name:"At-Takasur",ar:"Ø§Ù„ØªÙƒØ§Ø«Ø±",arti:"Bermegah-megahan",ayat:8,type:"Makkiyah",juz:30},{no:103,name:"Al-'Asr",ar:"Ø§Ù„Ø¹ØµØ±",arti:"Masa",ayat:3,type:"Makkiyah",juz:30},{no:104,name:"Al-Humazah",ar:"Ø§Ù„Ù‡Ù…Ø²Ø©",arti:"Pengumpat",ayat:9,type:"Makkiyah",juz:30},{no:105,name:"Al-Fil",ar:"Ø§Ù„ÙÙŠÙ„",arti:"Gajah",ayat:5,type:"Makkiyah",juz:30},{no:106,name:"Quraisy",ar:"Ù‚Ø±ÙŠØ´",arti:"Suku Quraisy",ayat:4,type:"Makkiyah",juz:30},{no:107,name:"Al-Ma'un",ar:"Ø§Ù„Ù…Ø§Ø¹ÙˆÙ†",arti:"Barang yang Berguna",ayat:7,type:"Makkiyah",juz:30},{no:108,name:"Al-Kausar",ar:"Ø§Ù„ÙƒÙˆØ«Ø±",arti:"Nikmat Berlimpah",ayat:3,type:"Makkiyah",juz:30},{no:109,name:"Al-Kafirun",ar:"Ø§Ù„ÙƒØ§ÙØ±ÙˆÙ†",arti:"Orang-Orang Kafir",ayat:6,type:"Makkiyah",juz:30},{no:110,name:"An-Nasr",ar:"Ø§Ù„Ù†ØµØ±",arti:"Pertolongan",ayat:3,type:"Madaniyah",juz:30},{no:111,name:"Al-Masad",ar:"Ø§Ù„Ù…Ø³Ø¯",arti:"Gejolak Api",ayat:5,type:"Makkiyah",juz:30},{no:112,name:"Al-Ikhlas",ar:"Ø§Ù„Ø¥Ø®Ù„Ø§Øµ",arti:"Ikhlas",ayat:4,type:"Makkiyah",juz:30},{no:113,name:"Al-Falaq",ar:"Ø§Ù„ÙÙ„Ù‚",arti:"Waktu Subuh",ayat:5,type:"Makkiyah",juz:30},{no:114,name:"An-Nas",ar:"Ø§Ù„Ù†Ø§Ø³",arti:"Manusia",ayat:6,type:"Makkiyah",juz:30}];

const JUZ30_SURAHS=ALL_SURAHS.filter(s=>s.juz===30);

const shalatSteps=[
    {title:"Niat",icon:"ğŸ¤²",desc:"Niat shalat diucapkan dalam hati:",arabic:"Ø£ÙØµÙÙ„ÙÙ‘ÙŠ ÙÙØ±Ù’Ø¶Ù Ø§Ù„ØµÙÙ‘Ø¨Ù’Ø­Ù Ø±ÙÙƒÙ’Ø¹ÙØªÙÙŠÙ’Ù†Ù Ù…ÙØ³Ù’ØªÙÙ‚Ù’Ø¨ÙÙ„Ù Ø§Ù„Ù’Ù‚ÙØ¨Ù’Ù„ÙØ©Ù Ø£ÙØ¯ÙØ§Ø¡Ù‹ Ù„ÙÙ„ÙÙ‘Ù‡Ù ØªÙØ¹ÙØ§Ù„ÙÙ‰",latin:"Ushalli fardhas shubhi rak'ataini mustaqbilal qiblati adaa'an lillahi ta'ala",arti:"Aku niat shalat fardhu Subuh dua rakaat menghadap kiblat karena Allah Ta'ala"},
    {title:"Takbiratul Ihram",icon:"ğŸ™Œ",desc:"Mengangkat kedua tangan sejajar telinga:",arabic:"Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø£ÙÙƒÙ’Ø¨ÙØ±Ù",latin:"Allahu Akbar",arti:"Allah Maha Besar"},
    {title:"Doa Iftitah",icon:"ğŸ“–",desc:"Dibaca setelah takbiratul ihram:",arabic:"Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø£ÙÙƒÙ’Ø¨ÙØ±Ù ÙƒÙØ¨ÙÙŠØ±Ù‹Ø§ ÙˆÙØ§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„ÙÙ‘Ù‡Ù ÙƒÙØ«ÙÙŠØ±Ù‹Ø§ ÙˆÙØ³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø¨ÙÙƒÙ’Ø±ÙØ©Ù‹ ÙˆÙØ£ÙØµÙÙŠÙ„Ø§Ù‹ . Ø¥ÙÙ†ÙÙ‘ÙŠ ÙˆÙØ¬ÙÙ‘Ù‡Ù’ØªÙ ÙˆÙØ¬Ù’Ù‡ÙÙŠÙ Ù„ÙÙ„ÙÙ‘Ø°ÙÙŠ ÙÙØ·ÙØ±Ù Ø§Ù„Ø³ÙÙ‘Ù…ÙØ§ÙˆÙØ§ØªÙ ÙˆÙØ§Ù„Ø£ÙØ±Ù’Ø¶Ù Ø­ÙÙ†ÙÙŠÙÙ‹Ø§ Ù…ÙØ³Ù’Ù„ÙÙ…Ù‹Ø§ ÙˆÙÙ…ÙØ§ Ø£ÙÙ†ÙØ§ Ù…ÙÙ†Ù Ø§Ù„Ù’Ù…ÙØ´Ù’Ø±ÙÙƒÙÙŠÙ†Ù",latin:"Allahu Akbaru kabiraw walhamdu lillahi katsiraw wa subhanallahi bukrataw wa ashila...",arti:"Allah Maha Besar, segala puji bagi Allah dengan pujian yang banyak..."},
    {title:"Al-Fatihah",icon:"ğŸ“–",desc:"Wajib dibaca di setiap rakaat:",arabic:"Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø§Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ†Ù Ø§Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù ï´¿Ù¡ï´¾ Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„ÙÙ‘Ù‡Ù Ø±ÙØ¨ÙÙ‘ Ø§Ù„Ù’Ø¹ÙØ§Ù„ÙÙ…ÙÙŠÙ†Ù ï´¿Ù¢ï´¾ Ø§Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ†Ù Ø§Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù ï´¿Ù£ï´¾ Ù…ÙØ§Ù„ÙÙƒÙ ÙŠÙÙˆÙ’Ù…Ù Ø§Ù„Ø¯ÙÙ‘ÙŠÙ†Ù ï´¿Ù¤ï´¾ Ø¥ÙÙŠÙÙ‘Ø§ÙƒÙ Ù†ÙØ¹Ù’Ø¨ÙØ¯Ù ÙˆÙØ¥ÙÙŠÙÙ‘Ø§ÙƒÙ Ù†ÙØ³Ù’ØªÙØ¹ÙÙŠÙ†Ù ï´¿Ù¥ï´¾ Ø§Ù‡Ù’Ø¯ÙÙ†ÙØ§ Ø§Ù„ØµÙÙ‘Ø±ÙØ§Ø·Ù Ø§Ù„Ù’Ù…ÙØ³Ù’ØªÙÙ‚ÙÙŠÙ…Ù ï´¿Ù¦ï´¾ ØµÙØ±ÙØ§Ø·Ù Ø§Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù Ø£ÙÙ†Ù’Ø¹ÙÙ…Ù’ØªÙ Ø¹ÙÙ„ÙÙŠÙ’Ù‡ÙÙ…Ù’ ØºÙÙŠÙ’Ø±Ù Ø§Ù„Ù’Ù…ÙØºÙ’Ø¶ÙÙˆØ¨Ù Ø¹ÙÙ„ÙÙŠÙ’Ù‡ÙÙ…Ù’ ÙˆÙÙ„ÙØ§ Ø§Ù„Ø¶ÙÙ‘Ø§Ù„ÙÙ‘ÙŠÙ†Ù ï´¿Ù§ï´¾",latin:"Bismillahir rahmanir rahim. Alhamdu lillahi rabbil 'aalamiin...",arti:"Dengan nama Allah Yang Maha Pengasih, Maha Penyayang. Segala puji bagi Allah, Tuhan seluruh alam..."},
    {title:"Ruku",icon:"ğŸ™‡",desc:"Membungkukkan badan:",arabic:"Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ø±ÙØ¨ÙÙ‘ÙŠÙ Ø§Ù„Ù’Ø¹ÙØ¸ÙÙŠÙ…Ù ÙˆÙØ¨ÙØ­ÙÙ…Ù’Ø¯ÙÙ‡Ù",latin:"Subhaana rabbiyal 'adziimi wa bihamdih (3x)",arti:"Maha Suci Tuhanku Yang Maha Agung dan dengan memuji-Nya (3x)"},
    {title:"I'tidal",icon:"ğŸ§",desc:"Berdiri tegak setelah ruku:",arabic:"Ø³ÙÙ…ÙØ¹Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ù„ÙÙ…ÙÙ†Ù’ Ø­ÙÙ…ÙØ¯ÙÙ‡Ù\nØ±ÙØ¨ÙÙ‘Ù†ÙØ§ ÙˆÙÙ„ÙÙƒÙ Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù",latin:"Sami'allahu liman hamidah. Rabbanaa wa lakal hamdu.",arti:"Allah mendengar orang yang memuji-Nya. Wahai Tuhan kami, bagi-Mu segala puji."},
    {title:"Sujud",icon:"ğŸ¤²",desc:"Meletakkan dahi di lantai:",arabic:"Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ø±ÙØ¨ÙÙ‘ÙŠÙ Ø§Ù„Ù’Ø£ÙØ¹Ù’Ù„ÙÙ‰ ÙˆÙØ¨ÙØ­ÙÙ…Ù’Ø¯ÙÙ‡Ù",latin:"Subhaana rabbiyal a'laa wa bihamdih (3x)",arti:"Maha Suci Tuhanku Yang Maha Tinggi dan dengan memuji-Nya (3x)"},
    {title:"Duduk Antara Sujud",icon:"ğŸ§",desc:"Duduk di antara dua sujud:",arabic:"Ø±ÙØ¨ÙÙ‘ Ø§ØºÙ’ÙÙØ±Ù’ Ù„ÙÙŠ ÙˆÙØ§Ø±Ù’Ø­ÙÙ…Ù’Ù†ÙÙŠ ÙˆÙØ§Ø¬Ù’Ø¨ÙØ±Ù’Ù†ÙÙŠ ÙˆÙØ§Ø±Ù’ÙÙØ¹Ù’Ù†ÙÙŠ ÙˆÙØ§Ø±Ù’Ø²ÙÙ‚Ù’Ù†ÙÙŠ ÙˆÙØ§Ù‡Ù’Ø¯ÙÙ†ÙÙŠ ÙˆÙØ¹ÙØ§ÙÙÙ†ÙÙŠ ÙˆÙØ§Ø¹Ù’ÙÙ Ø¹ÙÙ†ÙÙ‘ÙŠ",latin:"Rabbighfir lii warhamnii wajburnii warfa'nii warzuqnii wahdinii wa 'aafinii wa'fu 'annii",arti:"Ya Allah, ampunilah aku, rahmatilah aku, cukupkanlah aku, angkatlah derajatku..."},
    {title:"Tasyahud Awal",icon:"â˜ï¸",desc:"Duduk setelah rakaat kedua:",arabic:"Ø§Ù„ØªÙÙ‘Ø­ÙÙŠÙÙ‘Ø§ØªÙ Ø§Ù„Ù’Ù…ÙØ¨ÙØ§Ø±ÙÙƒÙØ§ØªÙ Ø§Ù„ØµÙÙ‘Ù„ÙÙˆÙØ§ØªÙ Ø§Ù„Ø·ÙÙ‘ÙŠÙÙ‘Ø¨ÙØ§ØªÙ Ù„ÙÙ„ÙÙ‘Ù‡Ù . Ø§Ù„Ø³ÙÙ‘Ù„Ø§ÙÙ…Ù Ø¹ÙÙ„ÙÙŠÙ’ÙƒÙ Ø£ÙÙŠÙÙ‘Ù‡ÙØ§ Ø§Ù„Ù†ÙÙ‘Ø¨ÙÙŠÙÙ‘ ÙˆÙØ±ÙØ­Ù’Ù…ÙØ©Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù ÙˆÙØ¨ÙØ±ÙÙƒÙØ§ØªÙÙ‡Ù . Ø§Ù„Ø³ÙÙ‘Ù„Ø§ÙÙ…Ù Ø¹ÙÙ„ÙÙŠÙ’Ù†ÙØ§ ÙˆÙØ¹ÙÙ„ÙÙ‰ Ø¹ÙØ¨ÙØ§Ø¯Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø§Ù„ØµÙÙ‘Ø§Ù„ÙØ­ÙÙŠÙ†Ù . Ø£ÙØ´Ù’Ù‡ÙØ¯Ù Ø£ÙÙ†Ù’ Ù„Ø§Ù Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„Ø§ÙÙ‘ Ø§Ù„Ù„ÙÙ‘Ù‡Ù ÙˆÙØ£ÙØ´Ù’Ù‡ÙØ¯Ù Ø£ÙÙ†ÙÙ‘ Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù‹Ø§ Ø±ÙØ³ÙÙˆÙ„Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù",latin:"At-tahiyyaatul mubaarakaatush shalawaatuth thayyibaatu lillah...",arti:"Segala kehormatan, keberkahan, shalawat, dan kebaikan bagi Allah..."},
    {title:"Tasyahud Akhir + Shalawat",icon:"â˜ï¸",desc:"Rakaat terakhir + shalawat Ibrahimiyah:",arabic:"Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ ØµÙÙ„ÙÙ‘ Ø¹ÙÙ„ÙÙ‰ Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù ÙˆÙØ¹ÙÙ„ÙÙ‰ Ø¢Ù„Ù Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù ÙƒÙÙ…ÙØ§ ØµÙÙ„ÙÙ‘ÙŠÙ’ØªÙ Ø¹ÙÙ„ÙÙ‰ Ø¥ÙØ¨Ù’Ø±ÙØ§Ù‡ÙÙŠÙ…Ù ÙˆÙØ¹ÙÙ„ÙÙ‰ Ø¢Ù„Ù Ø¥ÙØ¨Ù’Ø±ÙØ§Ù‡ÙÙŠÙ…Ù ÙˆÙØ¨ÙØ§Ø±ÙÙƒÙ’ Ø¹ÙÙ„ÙÙ‰ Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù ÙˆÙØ¹ÙÙ„ÙÙ‰ Ø¢Ù„Ù Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù ÙƒÙÙ…ÙØ§ Ø¨ÙØ§Ø±ÙÙƒÙ’ØªÙ Ø¹ÙÙ„ÙÙ‰ Ø¥ÙØ¨Ù’Ø±ÙØ§Ù‡ÙÙŠÙ…Ù ÙˆÙØ¹ÙÙ„ÙÙ‰ Ø¢Ù„Ù Ø¥ÙØ¨Ù’Ø±ÙØ§Ù‡ÙÙŠÙ…Ù ÙÙÙŠ Ø§Ù„Ù’Ø¹ÙØ§Ù„ÙÙ…ÙÙŠÙ†Ù Ø¥ÙÙ†ÙÙ‘ÙƒÙ Ø­ÙÙ…ÙÙŠØ¯ÙŒ Ù…ÙØ¬ÙÙŠØ¯ÙŒ",latin:"Allahumma shalli 'alaa Muhammad wa 'alaa aali Muhammad...",arti:"Ya Allah, rahmatilah Muhammad dan keluarga Muhammad..."},
    {title:"Salam",icon:"ğŸ‘‹",desc:"Menoleh ke kanan dan ke kiri:",arabic:"Ø§Ù„Ø³ÙÙ‘Ù„Ø§ÙÙ…Ù Ø¹ÙÙ„ÙÙŠÙ’ÙƒÙÙ…Ù’ ÙˆÙØ±ÙØ­Ù’Ù…ÙØ©Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù",latin:"Assalaamu 'alaikum wa rahmatullah (ke kanan dan ke kiri)",arti:"Semoga keselamatan dan rahmat Allah terlimpah kepada kalian"}
];

const doaData={
    ramadhan:[
        {title:"Doa Niat Puasa",arabic:"Ù†ÙÙˆÙÙŠÙ’ØªÙ ØµÙÙˆÙ’Ù…Ù ØºÙØ¯Ù Ø¹ÙÙ†Ù’ Ø£ÙØ¯ÙØ§Ø¡Ù ÙÙØ±Ù’Ø¶Ù Ø´ÙÙ‡Ù’Ø±Ù Ø±ÙÙ…ÙØ¶ÙØ§Ù†Ù Ù‡ÙØ°ÙÙ‡Ù Ø§Ù„Ø³ÙÙ‘Ù†ÙØ©Ù Ù„ÙÙ„ÙÙ‘Ù‡Ù ØªÙØ¹ÙØ§Ù„ÙÙ‰",latin:"Nawaitu shauma ghadin 'an adaa'i fardhi syahri ramadhaana haadzihis sanati lillahi ta'aalaa",arti:"Aku niat puasa esok hari untuk menunaikan fardhu bulan Ramadhan tahun ini karena Allah Ta'ala"},
        {title:"Doa Berbuka Puasa",arabic:"Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ù„ÙÙƒÙ ØµÙÙ…Ù’ØªÙ ÙˆÙØ¨ÙÙƒÙ Ø¢Ù…ÙÙ†Ù’ØªÙ ÙˆÙØ¹ÙÙ„ÙÙ‰ Ø±ÙØ²Ù’Ù‚ÙÙƒÙ Ø£ÙÙÙ’Ø·ÙØ±Ù’ØªÙ Ø¨ÙØ±ÙØ­Ù’Ù…ÙØªÙÙƒÙ ÙŠÙØ§ Ø£ÙØ±Ù’Ø­ÙÙ…Ù Ø§Ù„Ø±ÙÙ‘Ø§Ø­ÙÙ…ÙÙŠÙ†Ù",latin:"Allahumma laka shumtu wa bika aamantu wa 'alaa rizqika afthartu bi rahmatika yaa arhamar raahimiin",arti:"Ya Allah, untuk-Mu aku berpuasa, kepada-Mu aku beriman, dan dengan rezeki-Mu aku berbuka"},
        {title:"Doa Lailatul Qadar",arabic:"Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø¥ÙÙ†ÙÙ‘ÙƒÙ Ø¹ÙÙÙÙˆÙŒÙ‘ ØªÙØ­ÙØ¨ÙÙ‘ Ø§Ù„Ù’Ø¹ÙÙÙ’ÙˆÙ ÙÙØ§Ø¹Ù’ÙÙ Ø¹ÙÙ†ÙÙ‘ÙŠ",latin:"Allahumma innaka 'afuwwun tuhibbul 'afwa fa'fu 'annii",arti:"Ya Allah, Engkau Maha Pemaaf, Engkau menyukai maaf, maka maafkanlah aku"},
        {title:"Doa Melihat Hilal",arabic:"Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø£ÙÙ‡ÙÙ„ÙÙ‘Ù‡Ù Ø¹ÙÙ„ÙÙŠÙ’Ù†ÙØ§ Ø¨ÙØ§Ù„Ù’ÙŠÙÙ…Ù’Ù†Ù ÙˆÙØ§Ù„Ù’Ø¥ÙÙŠÙ…ÙØ§Ù†Ù ÙˆÙØ§Ù„Ø³ÙÙ‘Ù„ÙØ§Ù…ÙØ©Ù ÙˆÙØ§Ù„Ù’Ø¥ÙØ³Ù’Ù„ÙØ§Ù…Ù Ø±ÙØ¨ÙÙ‘ÙŠ ÙˆÙØ±ÙØ¨ÙÙ‘ÙƒÙ Ø§Ù„Ù„ÙÙ‘Ù‡Ù",latin:"Allahumma ahillahu 'alainaa bil yumni wal iimaani was salaamati wal islaam",arti:"Ya Allah, tampakkanlah bulan ini dengan keberuntungan, keimanan, keselamatan dan Islam"},
        {title:"Doa Setelah Tarawih",arabic:"Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø§Ø¬Ù’Ø¹ÙÙ„Ù’Ù†ÙØ§ Ù…ÙÙ†Ù Ø§Ù„Ù’ÙÙØ§Ø¦ÙØ²ÙÙŠÙ†Ù ÙˆÙØ§ÙƒÙ’ØªÙØ¨Ù’Ù†ÙØ§ Ù…ÙÙ†Ù Ø§Ù„Ù’Ù…ÙÙ‚Ù’Ø¨ÙÙˆÙ„ÙÙŠÙ†Ù",latin:"Allahummaj'alnaa minal faa-iziin waktub naa minal maqbuuliin",arti:"Ya Allah, jadikanlah kami orang-orang yang beruntung dan catatlah kami yang diterima amalnya"}
    ],
    harian:[
        {title:"Doa Bangun Tidur",arabic:"Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„ÙÙ‘Ù‡Ù Ø§Ù„ÙÙ‘Ø°ÙÙŠ Ø£ÙØ­Ù’ÙŠÙØ§Ù†ÙØ§ Ø¨ÙØ¹Ù’Ø¯Ù Ù…ÙØ§ Ø£ÙÙ…ÙØ§ØªÙÙ†ÙØ§ ÙˆÙØ¥ÙÙ„ÙÙŠÙ’Ù‡Ù Ø§Ù„Ù†ÙÙ‘Ø´ÙÙˆØ±Ù",latin:"Alhamdu lillahil ladzii ahyaanaa ba'da maa amaatanaa wa ilaihin nusyuur",arti:"Segala puji bagi Allah yang menghidupkan kami setelah mematikan kami"},
        {title:"Doa Masuk Kamar Mandi",arabic:"Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø¥ÙÙ†ÙÙ‘ÙŠ Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙÙƒÙ Ù…ÙÙ†Ù Ø§Ù„Ù’Ø®ÙØ¨ÙØ«Ù ÙˆÙØ§Ù„Ù’Ø®ÙØ¨ÙØ§Ø¦ÙØ«Ù",latin:"Allahumma innii a'uudzu bika minal khubutsi wal khabaa-its",arti:"Ya Allah, aku berlindung dari setan laki-laki dan perempuan"},
        {title:"Doa Keluar Rumah",arabic:"Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù ØªÙÙˆÙÙƒÙÙ‘Ù„Ù’ØªÙ Ø¹ÙÙ„ÙÙ‰ Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ù„Ø§Ù Ø­ÙÙˆÙ’Ù„Ù ÙˆÙÙ„Ø§Ù Ù‚ÙÙˆÙÙ‘Ø©Ù Ø¥ÙÙ„Ø§ÙÙ‘ Ø¨ÙØ§Ù„Ù„ÙÙ‘Ù‡Ù",latin:"Bismillahi tawakkaltu 'alallah, laa hawla wa laa quwwata illaa billah",arti:"Dengan nama Allah, aku bertawakal kepada Allah"},
        {title:"Doa Masuk Masjid",arabic:"Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø§ÙÙ’ØªÙØ­Ù’ Ù„ÙÙŠ Ø£ÙØ¨Ù’ÙˆÙØ§Ø¨Ù Ø±ÙØ­Ù’Ù…ÙØªÙÙƒÙ",latin:"Allahummaf-tah lii abwaaba rahmatik",arti:"Ya Allah, bukakanlah untukku pintu-pintu rahmat-Mu"},
        {title:"Doa Keluar Masjid",arabic:"Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø¥ÙÙ†ÙÙ‘ÙŠ Ø£ÙØ³Ù’Ø£ÙÙ„ÙÙƒÙ Ù…ÙÙ†Ù’ ÙÙØ¶Ù’Ù„ÙÙƒÙ",latin:"Allahumma innii as-aluka min fadhlik",arti:"Ya Allah, aku memohon karunia-Mu"}
    ],
    makan:[
        {title:"Doa Sebelum Makan",arabic:"Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù ÙˆÙØ¹ÙÙ„ÙÙ‰ Ø¨ÙØ±ÙÙƒÙØ©Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù",latin:"Bismillahi wa 'alaa barakatillah",arti:"Dengan nama Allah dan atas berkah Allah"},
        {title:"Doa Sesudah Makan",arabic:"Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„ÙÙ‘Ù‡Ù Ø§Ù„ÙÙ‘Ø°ÙÙŠ Ø£ÙØ·Ù’Ø¹ÙÙ…ÙÙ†ÙØ§ ÙˆÙØ³ÙÙ‚ÙØ§Ù†ÙØ§ ÙˆÙØ¬ÙØ¹ÙÙ„ÙÙ†ÙØ§ Ù…ÙÙ†Ù Ø§Ù„Ù’Ù…ÙØ³Ù’Ù„ÙÙ…ÙÙŠÙ†Ù",latin:"Alhamdu lillahil ladzii ath'amanaa wa saqaanaa wa ja'alanaa minal muslimiin",arti:"Segala puji bagi Allah yang memberi makan dan minum serta menjadikan kami muslim"}
    ],
    tidur:[
        {title:"Doa Sebelum Tidur",arabic:"Ø¨ÙØ§Ø³Ù’Ù…ÙÙƒÙ Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø£ÙØ­Ù’ÙŠÙØ§ ÙˆÙØ£ÙÙ…ÙÙˆØªÙ",latin:"Bismikallaahumma ahyaa wa amuut",arti:"Dengan nama-Mu ya Allah, aku hidup dan aku mati"},
        {title:"Doa Bangun Tidur",arabic:"Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„ÙÙ‘Ù‡Ù Ø§Ù„ÙÙ‘Ø°ÙÙŠ Ø£ÙØ­Ù’ÙŠÙØ§Ù†ÙØ§ Ø¨ÙØ¹Ù’Ø¯Ù Ù…ÙØ§ Ø£ÙÙ…ÙØ§ØªÙÙ†ÙØ§ ÙˆÙØ¥ÙÙ„ÙÙŠÙ’Ù‡Ù Ø§Ù„Ù†ÙÙ‘Ø´ÙÙˆØ±Ù",latin:"Alhamdu lillahil ladzii ahyaanaa ba'da maa amaatanaa wa ilaihin nusyuur",arti:"Segala puji bagi Allah yang menghidupkan kami setelah mematikan kami"}
    ],
    belajar:[
        {title:"Doa Sebelum Belajar",arabic:"Ø±ÙØ¨ÙÙ‘ Ø²ÙØ¯Ù’Ù†ÙÙŠ Ø¹ÙÙ„Ù’Ù…Ù‹Ø§ ÙˆÙØ§Ø±Ù’Ø²ÙÙ‚Ù’Ù†ÙÙŠ ÙÙÙ‡Ù’Ù…Ù‹Ø§",latin:"Rabbi zidnii 'ilman warzuqnii fahman",arti:"Ya Tuhanku, tambahkanlah aku ilmu dan berikanlah pemahaman"},
        {title:"Doa Sesudah Belajar",arabic:"Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø¥ÙÙ†ÙÙ‘ÙŠ Ø£ÙØ³Ù’ØªÙÙˆÙ’Ø¯ÙØ¹ÙÙƒÙ Ù…ÙØ§ Ø¹ÙÙ„ÙÙ‘Ù…Ù’ØªÙÙ†ÙÙŠÙ‡Ù ÙÙØ§Ø±Ù’Ø¯ÙØ¯Ù’Ù‡Ù Ø¥ÙÙ„ÙÙŠÙÙ‘ Ø¹ÙÙ†Ù’Ø¯Ù Ø­ÙØ§Ø¬ÙØªÙÙŠ",latin:"Allahumma innii astawdi'uka maa 'allamtaniihi fardud-hu ilayya 'inda haajatii",arti:"Ya Allah, aku titipkan apa yang telah Engkau ajarkan, kembalikanlah saat aku butuh"},
        {title:"Doa Mohon Kemudahan",arabic:"Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ù„Ø§Ù Ø³ÙÙ‡Ù’Ù„Ù Ø¥ÙÙ„Ø§ÙÙ‘ Ù…ÙØ§ Ø¬ÙØ¹ÙÙ„Ù’ØªÙÙ‡Ù Ø³ÙÙ‡Ù’Ù„Ø§Ù‹ ÙˆÙØ£ÙÙ†Ù’ØªÙ ØªÙØ¬Ù’Ø¹ÙÙ„Ù Ø§Ù„Ù’Ø­ÙØ²Ù’Ù†Ù Ø¥ÙØ°ÙØ§ Ø´ÙØ¦Ù’ØªÙ Ø³ÙÙ‡Ù’Ù„Ø§Ù‹",latin:"Allahumma laa sahla illaa maa ja'altahu sahlan wa anta taj'alul hazna idzaa syi'ta sahlan",arti:"Ya Allah, tidak ada kemudahan kecuali yang Engkau jadikan mudah"},
        {title:"Doa untuk Orang Tua",arabic:"Ø±ÙØ¨ÙÙ‘ Ø§Ø±Ù’Ø­ÙÙ…Ù’Ù‡ÙÙ…ÙØ§ ÙƒÙÙ…ÙØ§ Ø±ÙØ¨ÙÙ‘ÙŠÙØ§Ù†ÙÙŠ ØµÙØºÙÙŠØ±Ù‹Ø§",latin:"Rabbir hamhumaa kamaa rabbayaanii shaghiiraa",arti:"Ya Tuhanku, sayangilah keduanya sebagaimana mereka mendidikku waktu kecil"}
    ]
};

// ==================== GAS CODE ====================
function generateGasCode(ssId){
    const id=ssId||'MASUKKAN_SPREADSHEET_ID_DISINI';
    return `// =============================================
// KODE GOOGLE APPS SCRIPT - Amaliah Ramadhan 1447 H
// SMAN 10 Pinrang
// Spreadsheet ID sudah tertanam di baris bawah
// =============================================

const SPREADSHEET_ID = '${id}';

function doGet(e){return handleRequest(e)}
function doPost(e){return handleRequest(e)}

function handleRequest(e){
  if(!e||!e.parameter||!e.parameter.action){
    const info={status:'success',message:'âœ… API Amaliah Ramadhan 1447 H - SMAN 10 Pinrang aktif!',developer:'Murdani â€” 2026',version:'2.0',cara_pakai:'Tambahkan ?action=test di belakang URL'};
    return ContentService.createTextOutput(JSON.stringify(info,null,2)).setMimeType(ContentService.MimeType.JSON);
  }
  const action=e.parameter.action;let result;
  try{
    switch(action){
      case 'test':result=testConnection();break;
      case 'init':result=initSheets();break;
      case 'login':result=loginUser(e.parameter);break;
      case 'getUsers':result=getUsers();break;
      case 'addUser':result=addUser(e.parameter);break;
      case 'deleteUser':result=deleteUser(e.parameter);break;
      case 'insert':result=insertAmaliah(e.parameter);break;
      case 'read':result=readAmaliah(e.parameter);break;
      case 'setorHafalan':result=setorHafalan(e.parameter);break;
      case 'readHafalan':result=readHafalan(e.parameter);break;
      case 'nilaiHafalan':result=nilaiHafalan(e.parameter);break;
      default:result={status:'error',message:'Action tidak dikenali: "'+action+'". Gunakan: test, init, login, getUsers, addUser, deleteUser, insert, read, setorHafalan, readHafalan, nilaiHafalan'};
    }
  }catch(err){result={status:'error',message:'Terjadi kesalahan: '+err.toString()}}
  return ContentService.createTextOutput(JSON.stringify(result)).setMimeType(ContentService.MimeType.JSON);
}

function getSpreadsheet(){return SpreadsheetApp.openById(SPREADSHEET_ID)}

function getOrCreateSheet(name,headers){
  const ss=getSpreadsheet();let sheet=ss.getSheetByName(name);
  if(!sheet){sheet=ss.insertSheet(name);sheet.getRange(1,1,1,headers.length).setValues([headers]);sheet.getRange(1,1,1,headers.length).setBackground('#0d5c3f').setFontColor('white').setFontWeight('bold');sheet.setFrozenRows(1)}
  return sheet;
}

function testConnection(){
  try{const ss=getSpreadsheet();return{status:'success',message:'Koneksi berhasil! Spreadsheet: "'+ss.getName()+'"'}}
  catch(err){return{status:'error',message:'Gagal! Error: '+err.toString()}}
}

function initSheets(){
  const userHeaders=['Username','Password','Nama','Role','Kelas','Status'];
  const amaliahHeaders=['Timestamp','Username','Nama','Kelas','Tanggal','HariKe','Subuh','Dzuhur','Ashar','Maghrib','Isya','Tarawih','Witir','Dhuha','Tahajud','Sahur','Puasa','Sedekah','Dzikir','JuzBaca','Halaman','HafalanSurat','Catatan'];
  const hafalanHeaders=['Timestamp','Username','Nama','Kelas','Surat','NoSurat','DariAyat','SampaiAyat','CatatanSiswa','Status','Nilai','CatatanGuru','TglNilai','Penilai'];

  const userSheet=getOrCreateSheet('Users',userHeaders);
  getOrCreateSheet('DataAmaliah',amaliahHeaders);
  getOrCreateSheet('SetorHafalan',hafalanHeaders);

  const data=userSheet.getDataRange().getValues();
  const existing=data.slice(1).map(r=>String(r[0]));

  const defaults=[
    ['admin','admin123','Administrator','admin','-','active'],
    ['gurupai','guru123','Ustadz Ibrahim','guru','-','active'],
    ['gurupai2','guru123','Ustadzah Maryam','guru','-','active'],
    ['wali10a','wali123','Pak Ahmad S.Pd','wali','10-A','active'],
    ['wali10b','wali123','Ibu Fatimah S.Pd','wali','10-B','active'],
    ['wali11a','wali123','Pak Hasan M.Pd','wali','11-A','active'],
    ['10001','siswa123','Muhammad Rizki','siswa','10-A','active'],
    ['10002','siswa123','Aisyah Putri','siswa','10-A','active'],
    ['10003','siswa123','Abdullah Faqih','siswa','10-B','active'],
    ['10004','siswa123','Khadijah Zahra','siswa','11-A','active']
  ];

  let added=0;
  defaults.forEach(acc=>{if(!existing.includes(acc[0])){userSheet.appendRow(acc);added++}});
  return{status:'success',message:'Database siap! '+added+' akun ditambahkan. Sheet: Users, DataAmaliah, SetorHafalan.'};
}

function loginUser(p){
  const ss=getSpreadsheet();const sheet=ss.getSheetByName('Users');
  if(!sheet)return{status:'error',message:'Sheet Users belum ada. Klik Init Database.'};
  const data=sheet.getDataRange().getValues();
  for(let i=1;i<data.length;i++){
    if(String(data[i][0])===String(p.username)&&String(data[i][1])===String(p.password)&&String(data[i][3])===String(p.role)&&String(data[i][5])!=='inactive'){
      return{status:'success',user:{username:data[i][0],nama:data[i][2],role:data[i][3],kelas:data[i][4]}};
    }
  }
  return{status:'error',message:'Username/password salah atau role tidak sesuai!'};
}

function getUsers(){
  const ss=getSpreadsheet();const sheet=ss.getSheetByName('Users');
  if(!sheet)return{status:'success',data:[]};
  const data=sheet.getDataRange().getValues();const users=[];
  for(let i=1;i<data.length;i++){users.push({username:data[i][0],nama:data[i][2],role:data[i][3],kelas:data[i][4],status:data[i][5]})}
  return{status:'success',data:users};
}

function addUser(p){
  const sheet=getOrCreateSheet('Users',['Username','Password','Nama','Role','Kelas','Status']);
  const data=sheet.getDataRange().getValues();
  for(let i=1;i<data.length;i++){if(String(data[i][0])===String(p.username))return{status:'error',message:'Username sudah ada!'}}
  sheet.appendRow([p.username,p.password,p.nama,p.role,p.kelas||'-','active']);
  return{status:'success',message:'User "'+p.nama+'" berhasil ditambahkan!'};
}

function deleteUser(p){
  const ss=getSpreadsheet();const sheet=ss.getSheetByName('Users');
  if(!sheet)return{status:'error',message:'Sheet tidak ditemukan'};
  const data=sheet.getDataRange().getValues();
  for(let i=1;i<data.length;i++){
    if(String(data[i][0])===String(p.username)){
      if(data[i][0]==='admin')return{status:'error',message:'Akun admin tidak bisa dihapus!'};
      sheet.deleteRow(i+1);return{status:'success',message:'User berhasil dihapus!'};
    }
  }
  return{status:'error',message:'User tidak ditemukan'};
}

function insertAmaliah(p){
  const headers=['Timestamp','Username','Nama','Kelas','Tanggal','HariKe','Subuh','Dzuhur','Ashar','Maghrib','Isya','Tarawih','Witir','Dhuha','Tahajud','Sahur','Puasa','Sedekah','Dzikir','JuzBaca','Halaman','HafalanSurat','Catatan'];
  const sheet=getOrCreateSheet('DataAmaliah',headers);
  const data=sheet.getDataRange().getValues();
  const row=[new Date(),p.username||'',p.nama||'',p.kelas||'',p.tanggal||'',p.hariKe||'',p.subuh||'',p.dzuhur||'',p.ashar||'',p.maghrib||'',p.isya||'',p.tarawih||'',p.witir||'',p.dhuha||'',p.tahajud||'',p.sahur||'',p.puasa||'',p.sedekah||'',p.dzikir||'',p.juzBaca||'',p.halaman||'',p.hafalanSurat||'',p.catatan||''];
  for(let i=1;i<data.length;i++){
    if(String(data[i][1])===String(p.username)&&String(data[i][5])===String(p.hariKe)){
      sheet.getRange(i+1,1,1,row.length).setValues([row]);return{status:'success',message:'Amaliah hari ke-'+p.hariKe+' diperbarui!'};
    }
  }
  sheet.appendRow(row);return{status:'success',message:'Amaliah hari ke-'+p.hariKe+' disimpan!'};
}

function readAmaliah(p){
  const ss=getSpreadsheet();const sheet=ss.getSheetByName('DataAmaliah');
  if(!sheet)return{status:'success',data:[]};
  const data=sheet.getDataRange().getValues();const headers=data[0];const rows=[];
  for(let i=1;i<data.length;i++){
    const row={};for(let j=0;j<headers.length;j++)row[headers[j]]=data[i][j];
    if(p.role==='wali'&&p.kelas&&row.Kelas!==p.kelas)continue;
    if(p.role==='siswa'&&p.username&&String(row.Username)!==String(p.username))continue;
    rows.push(row);
  }
  return{status:'success',data:rows};
}

// ========== SETOR HAFALAN ==========
function setorHafalan(p){
  const headers=['Timestamp','Username','Nama','Kelas','Surat','NoSurat','DariAyat','SampaiAyat','CatatanSiswa','Status','Nilai','CatatanGuru','TglNilai','Penilai'];
  const sheet=getOrCreateSheet('SetorHafalan',headers);
  sheet.appendRow([new Date(),p.username||'',p.nama||'',p.kelas||'',p.surat||'',p.noSurat||'',p.dariAyat||'1',p.sampaiAyat||'',p.catatanSiswa||'','Menunggu','','','','']);
  return{status:'success',message:'Hafalan surat '+p.surat+' berhasil disetorkan! Menunggu penilaian guru.'};
}

function readHafalan(p){
  const ss=getSpreadsheet();const sheet=ss.getSheetByName('SetorHafalan');
  if(!sheet)return{status:'success',data:[]};
  const data=sheet.getDataRange().getValues();const headers=data[0];const rows=[];
  for(let i=1;i<data.length;i++){
    const row={};for(let j=0;j<headers.length;j++)row[headers[j]]=data[i][j];
    row._rowIndex=i+1;
    if(p.role==='siswa'&&p.username&&String(row.Username)!==String(p.username))continue;
    if(p.role==='wali'&&p.kelas&&row.Kelas!==p.kelas)continue;
    rows.push(row);
  }
  return{status:'success',data:rows};
}

function nilaiHafalan(p){
  const ss=getSpreadsheet();const sheet=ss.getSheetByName('SetorHafalan');
  if(!sheet)return{status:'error',message:'Sheet tidak ditemukan'};
  const rowIdx=parseInt(p.rowIndex);
  if(!rowIdx)return{status:'error',message:'Row index tidak valid'};
  sheet.getRange(rowIdx,10).setValue(p.status||'Menunggu');
  sheet.getRange(rowIdx,11).setValue(p.nilai||'');
  sheet.getRange(rowIdx,12).setValue(p.catatanGuru||'');
  sheet.getRange(rowIdx,13).setValue(new Date());
  sheet.getRange(rowIdx,14).setValue(p.penilai||'');
  return{status:'success',message:'Penilaian hafalan berhasil disimpan!'};
}`;
}

// ==================== STATE ====================
let currentUser=null,currentSurahNo=1,surahCache={},allAmaliahData=[],allUsersData=[],allHafalanData=[],hmSelectedStatus='';

// ==================== INIT ====================
document.addEventListener('DOMContentLoaded',function(){
    const saved=localStorage.getItem('amaliahUser');
    if(saved){currentUser=JSON.parse(saved);showMainApp()}
    updateGasCodeDisplay();updateIdStatus();
});

// ==================== LOGIN ====================
function updateLoginLabel(){
    const role=document.getElementById('loginRole').value;const label=document.getElementById('loginIdLabel');const input=document.getElementById('loginId');
    if(role==='siswa'){label.textContent='ğŸ“‹ NIS (Nomor Induk Siswa)';input.placeholder='Masukkan NIS';}
    else if(role==='guru'){label.textContent='ğŸ‘¨â€ğŸ« Username Guru PAI';input.placeholder='Masukkan username';}
    else if(role==='wali'){label.textContent='ğŸ‘©â€ğŸ« Username Wali Kelas';input.placeholder='Masukkan username';}
    else{label.textContent='ğŸ‘¨â€ğŸ’¼ Username Admin';input.placeholder='Masukkan username';}
}
function togglePw(){const pw=document.getElementById('loginPassword');pw.type=pw.type==='password'?'text':'password'}

function doLogin(){
    const role=document.getElementById('loginRole').value,username=document.getElementById('loginId').value.trim(),password=document.getElementById('loginPassword').value.trim(),errDiv=document.getElementById('loginError');
    if(!username||!password){errDiv.textContent='âš ï¸ Mohon isi username dan password!';errDiv.classList.remove('hidden');return}
    const btn=document.getElementById('btnLogin');btn.disabled=true;btn.innerHTML='â³ Memproses...';errDiv.classList.add('hidden');
    const gasUrl=getGasUrl();
    if(gasUrl){
        fetch(`${gasUrl}?${new URLSearchParams({action:'login',username,password,role})}`).then(r=>r.json()).then(data=>{
            if(data.status==='success'){currentUser=data.user;localStorage.setItem('amaliahUser',JSON.stringify(currentUser));showMainApp()}
            else{errDiv.textContent='âŒ '+data.message;errDiv.classList.remove('hidden')}
        }).catch(err=>{errDiv.textContent='âŒ Gagal terhubung ke server. Periksa koneksi internet & URL GAS.';errDiv.classList.remove('hidden')}).finally(()=>{btn.disabled=false;btn.innerHTML='ğŸ” Masuk'});
    }else{
        // Fallback: login offline menggunakan akun default (sebelum terhubung ke Spreadsheet)
        const acc=DEFAULT_ACCOUNTS.find(a=>a.username===username&&a.password===password&&a.role===role);
        if(acc){
            currentUser={username:acc.username,nama:acc.nama,role:acc.role,kelas:acc.kelas};
            localStorage.setItem('amaliahUser',JSON.stringify(currentUser));
            showMainApp();
            showToast('âš ï¸ Mode Offline â€” Hubungkan ke Google Spreadsheet untuk data real');
        }else{
            errDiv.textContent='âŒ Username/password salah atau role tidak sesuai! Pastikan Google Spreadsheet sudah terhubung.';
            errDiv.classList.remove('hidden');
        }
        btn.disabled=false;btn.innerHTML='ğŸ” Masuk';
    }
}

function doLogout(){if(confirm('Yakin ingin keluar?')){currentUser=null;localStorage.removeItem('amaliahUser');document.getElementById('mainApp').classList.add('hidden');document.getElementById('loginScreen').classList.remove('hidden');document.getElementById('loginId').value='';document.getElementById('loginPassword').value=''}}

// ==================== MAIN APP ====================
function showMainApp(){
    document.getElementById('loginScreen').classList.add('hidden');document.getElementById('mainApp').classList.remove('hidden');
    document.getElementById('headerName').textContent=currentUser.nama;
    document.getElementById('headerRole').textContent=ROLE_LABELS[currentUser.role]+(currentUser.kelas&&currentUser.kelas!=='-'?' - Kelas '+currentUser.kelas:'');
    document.getElementById('headerAvatar').textContent=ROLE_AVATARS[currentUser.role];
    document.getElementById('welcomeMsg').textContent=`Selamat datang, ${currentUser.nama}! Semoga Ramadhan penuh berkah.`;
    buildNavigation();initFormFields();initRamadhanDays();renderSurahList();buildShalatNav();showShalatStep(0);buildDoaNav();showDoaCategory('ramadhan');renderDashboard();loadSetupFields();initHafalanForm();renderJuz30List();showTab('beranda');
}

function buildNavigation(){
    const items=NAV_ITEMS[currentUser.role]||NAV_ITEMS.siswa;
    document.getElementById('navContainer').innerHTML=items.map((item,i)=>`<button onclick="showTab('${item.id}')" class="nav-btn px-3 py-3 text-white text-xs font-medium flex items-center gap-1 hover:bg-emerald-800 transition whitespace-nowrap ${i===0?'nav-active':''}" data-tab="${item.id}">${item.icon} <span class="hidden sm:inline">${item.label}</span></button>`).join('');
}

function showTab(tabName){
    document.querySelectorAll('.tab-content').forEach(t=>t.classList.remove('active'));
    document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('nav-active'));
    const tab=document.getElementById('tab-'+tabName);if(tab)tab.classList.add('active');
    const btn=document.querySelector(`[data-tab="${tabName}"]`);if(btn)btn.classList.add('nav-active');
    window.scrollTo({top:0,behavior:'smooth'});
}

// ==================== DASHBOARD ====================
function renderDashboard(){
    const d=document.getElementById('dashboardContent');
    if(currentUser.role==='siswa'){
        d.innerHTML=`<div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-white rounded-xl p-5 text-center card-hover shadow-md border-t-4 border-emerald-600 cursor-pointer" onclick="showTab('amaliah')"><div class="text-3xl mb-2">âœ…</div><h4 class="font-semibold text-emerald-800 text-sm">Isi Amaliah</h4></div>
            <div class="bg-white rounded-xl p-5 text-center card-hover shadow-md border-t-4 border-green-500 cursor-pointer" onclick="showTab('hafalan')"><div class="text-3xl mb-2">ğŸ“—</div><h4 class="font-semibold text-emerald-800 text-sm">Setor Hafalan</h4></div>
            <div class="bg-white rounded-xl p-5 text-center card-hover shadow-md border-t-4 border-amber-500 cursor-pointer" onclick="showTab('quran')"><div class="text-3xl mb-2">ğŸ“–</div><h4 class="font-semibold text-emerald-800 text-sm">Baca Al-Quran</h4></div>
            <div class="bg-white rounded-xl p-5 text-center card-hover shadow-md border-t-4 border-purple-500 cursor-pointer" onclick="showTab('progress')"><div class="text-3xl mb-2">ğŸ“ˆ</div><h4 class="font-semibold text-emerald-800 text-sm">Progress</h4></div>
        </div>
        <div class="bg-white rounded-2xl shadow-lg p-6"><h3 class="text-lg font-bold text-emerald-800 mb-3">ğŸ“‹ Panduan Amaliah</h3><div class="grid md:grid-cols-3 gap-4"><div class="bg-emerald-50 rounded-xl p-4"><h4 class="font-semibold text-emerald-700 mb-2">ğŸŒ… Wajib</h4><ul class="text-sm text-gray-700 space-y-1"><li>â˜‘ï¸ Puasa Ramadhan</li><li>â˜‘ï¸ Shalat 5 Waktu</li><li>â˜‘ï¸ Zakat Fitrah</li></ul></div><div class="bg-amber-50 rounded-xl p-4"><h4 class="font-semibold text-amber-700 mb-2">â­ Sunnah</h4><ul class="text-sm text-gray-700 space-y-1"><li>â˜‘ï¸ Tarawih & Witir</li><li>â˜‘ï¸ Tadarus Al-Quran</li><li>â˜‘ï¸ Sahur & Sedekah</li></ul></div><div class="bg-blue-50 rounded-xl p-4"><h4 class="font-semibold text-blue-700 mb-2">ğŸ“— Hafalan</h4><ul class="text-sm text-gray-700 space-y-1"><li>â˜‘ï¸ Hafalan Juz 30</li><li>â˜‘ï¸ Setor ke Guru PAI</li><li>â˜‘ï¸ Target 37 Surat</li></ul></div></div></div>`;
    }else if(currentUser.role==='guru'){
        d.innerHTML=`<div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-6">
            <div class="bg-white rounded-xl p-5 text-center card-hover shadow-md border-t-4 border-green-600 cursor-pointer" onclick="showTab('datahafalan')"><div class="text-3xl mb-2">ğŸ“—</div><h4 class="font-semibold text-emerald-800 text-sm">Nilai Hafalan</h4></div>
            <div class="bg-white rounded-xl p-5 text-center card-hover shadow-md border-t-4 border-emerald-600 cursor-pointer" onclick="showTab('data')"><div class="text-3xl mb-2">ğŸ“Š</div><h4 class="font-semibold text-emerald-800 text-sm">Data Amaliah</h4></div>
            <div class="bg-white rounded-xl p-5 text-center card-hover shadow-md border-t-4 border-amber-500 cursor-pointer" onclick="showTab('quran')"><div class="text-3xl mb-2">ğŸ“–</div><h4 class="font-semibold text-emerald-800 text-sm">Al-Quran</h4></div>
        </div>`;
    }else if(currentUser.role==='wali'){
        d.innerHTML=`<div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-6">
            <div class="bg-white rounded-xl p-5 text-center card-hover shadow-md border-t-4 border-emerald-600 cursor-pointer" onclick="showTab('data')"><div class="text-3xl mb-2">ğŸ“Š</div><h4 class="font-semibold text-emerald-800 text-sm">Data Kelas ${currentUser.kelas}</h4></div>
            <div class="bg-white rounded-xl p-5 text-center card-hover shadow-md border-t-4 border-green-500 cursor-pointer" onclick="showTab('datahafalan')"><div class="text-3xl mb-2">ğŸ“—</div><h4 class="font-semibold text-emerald-800 text-sm">Hafalan Kelas</h4></div>
            <div class="bg-white rounded-xl p-5 text-center card-hover shadow-md border-t-4 border-amber-500 cursor-pointer" onclick="showTab('quran')"><div class="text-3xl mb-2">ğŸ“–</div><h4 class="font-semibold text-emerald-800 text-sm">Al-Quran</h4></div>
        </div>`;
    }else{
        d.innerHTML=`<div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-white rounded-xl p-5 text-center card-hover shadow-md border-t-4 border-emerald-600 cursor-pointer" onclick="showTab('data')"><div class="text-3xl mb-2">ğŸ“Š</div><h4 class="font-semibold text-emerald-800 text-sm">Data Amaliah</h4></div>
            <div class="bg-white rounded-xl p-5 text-center card-hover shadow-md border-t-4 border-green-500 cursor-pointer" onclick="showTab('datahafalan')"><div class="text-3xl mb-2">ğŸ“—</div><h4 class="font-semibold text-emerald-800 text-sm">Hafalan</h4></div>
            <div class="bg-white rounded-xl p-5 text-center card-hover shadow-md border-t-4 border-amber-500 cursor-pointer" onclick="showTab('users')"><div class="text-3xl mb-2">ğŸ‘¥</div><h4 class="font-semibold text-emerald-800 text-sm">Kelola User</h4></div>
            <div class="bg-white rounded-xl p-5 text-center card-hover shadow-md border-t-4 border-purple-500 cursor-pointer" onclick="showTab('setup')"><div class="text-3xl mb-2">âš™ï¸</div><h4 class="font-semibold text-emerald-800 text-sm">Setup</h4></div>
        </div>`;
    }
}

// ==================== FORM ====================
function initFormFields(){
    const sel=document.getElementById('amHari');if(sel.options.length<=1){for(let i=1;i<=30;i++){const o=document.createElement('option');o.value=i;o.textContent=`Hari ke-${i}`;sel.appendChild(o)}}
    const juz=document.getElementById('amJuz');if(juz.options.length<=1){for(let i=1;i<=30;i++){const o=document.createElement('option');o.value=i;o.textContent=`Juz ${i}`;juz.appendChild(o)}}
    document.getElementById('amTanggal').value=new Date().toISOString().split('T')[0];
}
function initRamadhanDays(){const c=document.getElementById('ramadhanDays');let h='';for(let i=1;i<=30;i++){h+=`<div class="bg-emerald-100 hover:bg-emerald-200 text-emerald-800 rounded-lg p-2 text-center text-sm font-medium cursor-pointer transition" onclick="this.classList.toggle('bg-amber-400');this.classList.toggle('bg-emerald-100');this.classList.toggle('text-white');this.classList.toggle('text-emerald-800')">${i}</div>`}c.innerHTML=h}

// ==================== SETOR HAFALAN ====================
function initHafalanForm(){
    const sel=document.getElementById('hfSurat');if(!sel)return;
    if(sel.options.length<=1){JUZ30_SURAHS.forEach(s=>{const o=document.createElement('option');o.value=s.name;o.textContent=`${s.no}. ${s.name} (${s.ar}) - ${s.ayat} ayat`;o.dataset.ayat=s.ayat;o.dataset.no=s.no;sel.appendChild(o)})}
    sel.addEventListener('change',function(){const opt=this.selectedOptions[0];if(opt&&opt.dataset.ayat){document.getElementById('hfSampaiAyat').value=opt.dataset.ayat;document.getElementById('hfDariAyat').value=1}});
    document.getElementById('hfTanggal').value=new Date().toISOString().split('T')[0];
}

function renderJuz30List(){
    const c=document.getElementById('juz30SurahList');if(!c)return;
    c.innerHTML=JUZ30_SURAHS.map(s=>`<div class="flex items-center gap-3 p-3 rounded-xl border border-gray-100 hover:border-emerald-400 hover:shadow-md transition cursor-pointer" onclick="openSurah(${s.no})"><div class="w-9 h-9 bg-emerald-600 text-white rounded-lg flex items-center justify-center font-bold text-xs flex-shrink-0">${s.no}</div><div class="flex-1 min-w-0"><h4 class="font-semibold text-emerald-800 text-sm">${s.name}</h4><p class="text-xs text-gray-500">${s.arti} â€¢ ${s.ayat} ayat</p></div><div class="arabic text-lg gold-text flex-shrink-0">${s.ar}</div></div>`).join('');
}

function submitSetorHafalan(){
    const surat=document.getElementById('hfSurat').value;if(!surat){showToast('âš ï¸ Pilih surat terlebih dahulu!');return}
    const opt=document.getElementById('hfSurat').selectedOptions[0];
    const data={action:'setorHafalan',username:currentUser.username,nama:currentUser.nama,kelas:currentUser.kelas,surat:surat,noSurat:opt.dataset.no||'',dariAyat:document.getElementById('hfDariAyat').value||'1',sampaiAyat:document.getElementById('hfSampaiAyat').value||'',catatanSiswa:document.getElementById('hfCatatan').value||''};
    const url=getGasUrl();const btn=document.getElementById('btnSetorHafalan');btn.disabled=true;btn.innerHTML='â³ Mengirim...';
    if(!url){let local=JSON.parse(localStorage.getItem('hafalanLocal')||'[]');data.Timestamp=new Date().toISOString();data.Status='Menunggu';data.Nama=currentUser.nama;data.Kelas=currentUser.kelas;data.Surat=surat;local.push(data);localStorage.setItem('hafalanLocal',JSON.stringify(local));showToast('âœ… Hafalan disimpan lokal! Hubungkan GAS untuk kirim ke guru.');btn.disabled=false;btn.innerHTML='ğŸ“¤ Setor Hafalan ke Guru PAI';return}
    fetch(`${url}?${new URLSearchParams(data)}`).then(r=>r.json()).then(res=>{showToast(res.status==='success'?'âœ… '+res.message:'âŒ '+res.message)}).catch(err=>showToast('âŒ '+err.message)).finally(()=>{btn.disabled=false;btn.innerHTML='ğŸ“¤ Setor Hafalan ke Guru PAI'});
}

function loadMyHafalan(){
    const url=getGasUrl();
    if(!url){const data=JSON.parse(localStorage.getItem('hafalanLocal')||'[]').filter(r=>(r.username||r.Username)===currentUser.username);renderMyHafalan(data);return}
    document.getElementById('myHafalanList').innerHTML='<p class="text-center text-blue-500 py-6">ğŸ”„ Memuat...</p>';
    fetch(`${url}?${new URLSearchParams({action:'readHafalan',role:'siswa',username:currentUser.username})}`).then(r=>r.json()).then(res=>{if(res.status==='success')renderMyHafalan(res.data)}).catch(err=>document.getElementById('myHafalanList').innerHTML=`<p class="text-center text-red-500">âŒ ${err.message}</p>`);
}

function renderMyHafalan(data){
    if(!data.length){document.getElementById('myHafalanList').innerHTML='<p class="text-gray-400 text-center py-6">Belum ada setoran hafalan</p>';return}
    document.getElementById('myHafalanList').innerHTML=data.map(r=>{
        const st=r.Status||r.status||'Menunggu';
        const stClass=st==='Lancar'?'status-lancar':st==='Kurang Lancar'?'status-kurang':st==='Belum Lancar'?'status-belum':'status-menunggu';
        return`<div class="hafalan-card border rounded-xl p-4 mb-3"><div class="flex justify-between items-start"><div><h4 class="font-semibold text-emerald-800">${r.Surat||r.surat||''}</h4><p class="text-xs text-gray-500">Ayat ${r.DariAyat||r.dariAyat||1} - ${r.SampaiAyat||r.sampaiAyat||''} â€¢ ${r.Timestamp?new Date(r.Timestamp).toLocaleDateString('id'):(r.tanggal||'')}</p></div><span class="px-3 py-1 rounded-full text-xs font-semibold ${stClass}">${st==='Menunggu'?'â³':st==='Lancar'?'âœ…':st==='Kurang Lancar'?'âš ï¸':'âŒ'} ${st}</span></div>${r.Nilai||r.nilai?`<p class="text-sm mt-2"><strong>Nilai:</strong> ${r.Nilai||r.nilai}</p>`:''} ${r.CatatanGuru||r.catatanGuru?`<p class="text-sm text-gray-600 mt-1"><strong>Catatan Guru:</strong> ${r.CatatanGuru||r.catatanGuru}</p>`:''}</div>`;
    }).join('');
}

// ==================== DATA HAFALAN (GURU) ====================
function loadAllHafalan(){
    const url=getGasUrl();
    if(!url){const local=JSON.parse(localStorage.getItem('hafalanLocal')||'[]');allHafalanData=local;renderHafalanTable(local);showToast('ğŸ“‹ Data lokal dimuat.');return}
    document.getElementById('hafalanBody').innerHTML='<tr><td colspan="9" class="text-center py-8 text-blue-500">ğŸ”„ Memuat...</td></tr>';
    fetch(`${url}?${new URLSearchParams({action:'readHafalan',role:currentUser.role,kelas:currentUser.kelas||'',username:currentUser.username})}`).then(r=>r.json()).then(res=>{if(res.status==='success'){allHafalanData=res.data;renderHafalanTable(res.data)}}).catch(err=>document.getElementById('hafalanBody').innerHTML=`<tr><td colspan="9" class="text-center py-8 text-red-500">âŒ ${err.message}</td></tr>`);
}

function renderHafalanTable(data){
    if(!data.length){document.getElementById('hafalanBody').innerHTML='<tr><td colspan="9" class="text-center py-8 text-gray-400">Belum ada data</td></tr>';return}
    document.getElementById('hafalanBody').innerHTML=data.map((r,i)=>{
        const st=r.Status||r.status||'Menunggu';
        const stClass=st==='Lancar'?'status-lancar':st==='Kurang Lancar'?'status-kurang':st==='Belum Lancar'?'status-belum':'status-menunggu';
        return`<tr class="${i%2===0?'bg-white':'bg-gray-50'} hover:bg-amber-50"><td class="px-2 py-2 text-center">${i+1}</td><td class="px-2 py-2 font-medium">${r.Nama||r.nama||''}</td><td class="px-2 py-2 text-center">${r.Kelas||r.kelas||''}</td><td class="px-2 py-2">${r.Surat||r.surat||''}</td><td class="px-2 py-2 text-center">${r.DariAyat||r.dariAyat||1}-${r.SampaiAyat||r.sampaiAyat||''}</td><td class="px-2 py-2 text-center text-xs">${r.Timestamp?new Date(r.Timestamp).toLocaleDateString('id'):''}</td><td class="px-2 py-2 text-center"><span class="px-2 py-0.5 rounded-full text-xs font-medium ${stClass}">${st}</span></td><td class="px-2 py-2 text-center font-bold">${r.Nilai||r.nilai||'-'}</td><td class="px-2 py-2 text-center">${currentUser.role==='guru'||currentUser.role==='admin'?`<button onclick="openPenilaian(${i})" class="bg-amber-500 hover:bg-amber-600 text-white px-2 py-1 rounded text-xs">ğŸ“ Nilai</button>`:'-'}</td></tr>`;
    }).join('');
}

function filterHafalanData(){
    const search=(document.getElementById('searchHafalan').value||'').toLowerCase();const status=document.getElementById('filterHafalanStatus').value;
    renderHafalanTable(allHafalanData.filter(r=>{const nama=(r.Nama||r.nama||'').toLowerCase();const st=r.Status||r.status||'';return nama.includes(search)&&(!status||st===status)}));
}

function openPenilaian(idx){
    const r=allHafalanData[idx];if(!r)return;
    document.getElementById('hmRowIndex').value=r._rowIndex||'';
    document.getElementById('hmNama').textContent=r.Nama||r.nama||'';
    document.getElementById('hmSurat').textContent=r.Surat||r.surat||'';
    document.getElementById('hmAyat').textContent=`${r.DariAyat||r.dariAyat||1} - ${r.SampaiAyat||r.sampaiAyat||''}`;
    document.getElementById('hmNilai').value=r.Nilai||r.nilai||'';
    document.getElementById('hmCatatanGuru').value=r.CatatanGuru||r.catatanGuru||'';
    hmSelectedStatus=r.Status||r.status||'';
    updateHmStatusBtns();
    document.getElementById('hafalanModal').classList.add('show');document.body.style.overflow='hidden';
}

function setHmStatus(val){hmSelectedStatus=val;updateHmStatusBtns()}
function updateHmStatusBtns(){document.querySelectorAll('.hm-status-btn').forEach(b=>{b.classList.toggle('border-emerald-600',b.dataset.val===hmSelectedStatus);b.classList.toggle('ring-2',b.dataset.val===hmSelectedStatus)})}
function closeHafalanModal(){document.getElementById('hafalanModal').classList.remove('show');document.body.style.overflow='auto'}

function submitPenilaianHafalan(){
    if(!hmSelectedStatus){showToast('âš ï¸ Pilih status penilaian!');return}
    const url=getGasUrl();if(!url){showToast('âš ï¸ Hubungkan GAS terlebih dahulu!');return}
    const data={action:'nilaiHafalan',rowIndex:document.getElementById('hmRowIndex').value,status:hmSelectedStatus,nilai:document.getElementById('hmNilai').value,catatanGuru:document.getElementById('hmCatatanGuru').value,penilai:currentUser.nama};
    fetch(`${url}?${new URLSearchParams(data)}`).then(r=>r.json()).then(res=>{showToast(res.status==='success'?'âœ… '+res.message:'âŒ '+res.message);if(res.status==='success'){closeHafalanModal();loadAllHafalan()}}).catch(err=>showToast('âŒ '+err.message));
}

// ==================== AL-QURAN ====================
function showQuranView(view){
    document.getElementById('quranSurahView').classList.toggle('hidden',view!=='surah');document.getElementById('quranJuzView').classList.toggle('hidden',view!=='juz');
    document.getElementById('btnViewSurah').className=view==='surah'?'bg-emerald-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition':'bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium transition';
    document.getElementById('btnViewJuz').className=view==='juz'?'bg-emerald-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition':'bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium transition';
    if(view==='juz')renderJuzList();
}
function renderSurahList(filter=''){
    const c=document.getElementById('surahListContainer');
    const filtered=ALL_SURAHS.filter(s=>s.name.toLowerCase().includes(filter.toLowerCase())||s.arti.toLowerCase().includes(filter.toLowerCase())||s.ar.includes(filter));
    c.innerHTML=filtered.map(s=>`<div class="surah-item flex items-center gap-3 p-3 rounded-xl border border-gray-100 cursor-pointer hover:border-emerald-400 hover:shadow-md transition" onclick="openSurah(${s.no})"><div class="w-9 h-9 bg-emerald-600 text-white rounded-lg flex items-center justify-center font-bold text-xs flex-shrink-0">${s.no}</div><div class="flex-1 min-w-0"><h4 class="font-semibold text-emerald-800 text-sm">${s.name}</h4><p class="text-xs text-gray-500 truncate">${s.arti} â€¢ ${s.ayat} ayat â€¢ ${s.type}</p></div><div class="arabic text-lg gold-text flex-shrink-0">${s.ar}</div></div>`).join('');
}
function filterSurahList(){renderSurahList(document.getElementById('searchSurah').value)}
function renderJuzList(){
    const c=document.getElementById('juzListContainer');let html='';
    for(let j=1;j<=30;j++){const surahs=ALL_SURAHS.filter(s=>s.juz===j);const names=surahs.length>2?surahs[0].name+' - '+surahs[surahs.length-1].name:surahs.map(s=>s.name).join(', ');
    html+=`<div class="bg-white rounded-xl p-4 border border-gray-200 cursor-pointer hover:border-emerald-400 hover:shadow-md card-hover text-center" onclick="openJuz(${j})"><div class="text-2xl mb-1">ğŸ“š</div><div class="font-bold text-emerald-800">Juz ${j}</div><p class="text-xs text-gray-500 mt-1">${names}</p></div>`}
    c.innerHTML=html;
}
function openJuz(juzNo){const surahs=ALL_SURAHS.filter(s=>s.juz===juzNo);if(surahs.length>0)openSurah(surahs[0].no)}

async function openSurah(no){
    currentSurahNo=no;const s=ALL_SURAHS.find(x=>x.no===no);
    document.getElementById('rdSurahName').textContent=`${s.name} (${s.ar})`;
    document.getElementById('rdSurahInfo').textContent=`Surat ke-${s.no} â€¢ ${s.ayat} ayat â€¢ ${s.type} â€¢ Juz ${s.juz}`;
    document.getElementById('rdSurahBody').innerHTML='<div class="text-center py-10"><div class="text-4xl animate-pulse mb-3">ğŸ“–</div><p class="text-gray-400">Memuat surat...</p></div>';
    document.getElementById('surahModal').classList.add('show');document.body.style.overflow='hidden';
    try{
        if(surahCache[no]){renderSurahContent(surahCache[no],s)}
        else{const res=await fetch(`https://api.alquran.cloud/v1/surah/${no}/editions/quran-uthmani,id.indonesian`);const json=await res.json();if(json.code===200){surahCache[no]=json.data;renderSurahContent(json.data,s)}else document.getElementById('rdSurahBody').innerHTML='<p class="text-center text-red-500 py-10">Gagal memuat.</p>'}
    }catch(err){document.getElementById('rdSurahBody').innerHTML=`<p class="text-center text-red-500 py-10">âŒ Error: ${err.message}</p>`}
}
function renderSurahContent(data,surahInfo){
    const arabic=data[0],indo=data[1];let html='';
    if(surahInfo.no!==9&&surahInfo.no!==1)html+=`<div class="arabic text-center text-2xl gold-text bg-emerald-50 rounded-xl p-4 mb-5">Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø§Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ†Ù Ø§Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù</div>`;
    html+='<div class="space-y-1">';
    for(let i=0;i<arabic.ayahs.length;i++){html+=`<div class="ayah-text"><div class="flex items-start gap-3"><span class="bg-emerald-600 text-white rounded-full w-7 h-7 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-1">${arabic.ayahs[i].numberInSurah}</span><div class="flex-1"><p class="arabic text-xl md:text-2xl text-gray-800 leading-loose mb-2">${arabic.ayahs[i].text}</p><p class="text-sm text-gray-600 leading-relaxed">${indo.ayahs[i].text}</p></div></div></div>`}
    html+='</div>';document.getElementById('rdSurahBody').innerHTML=html;
}
function closeSurahModal(){document.getElementById('surahModal').classList.remove('show');document.body.style.overflow='auto'}
function prevSurah(){if(currentSurahNo>1)openSurah(currentSurahNo-1)}
function nextSurah(){if(currentSurahNo<114)openSurah(currentSurahNo+1)}

// ==================== SHALAT ====================
function buildShalatNav(){document.getElementById('shalatNav').innerHTML=shalatSteps.map((s,i)=>`<button onclick="showShalatStep(${i})" class="shalat-step-btn ${i===0?'bg-emerald-600 text-white':'bg-gray-200 text-gray-700'} px-3 py-2 rounded-full text-xs font-medium whitespace-nowrap transition">${i+1}. ${s.title}</button>`).join('')}
function showShalatStep(idx){
    const s=shalatSteps[idx];document.querySelectorAll('.shalat-step-btn').forEach((b,i)=>{b.className=`shalat-step-btn ${i===idx?'bg-emerald-600 text-white':'bg-gray-200 text-gray-700'} px-3 py-2 rounded-full text-xs font-medium whitespace-nowrap transition`});
    document.getElementById('shalatContent').innerHTML=`<div class="fade-in"><div class="bg-gradient-to-r from-emerald-50 to-amber-50 rounded-2xl p-5 border border-emerald-200"><div class="flex items-center gap-3 mb-4"><span class="text-3xl">${s.icon}</span><h4 class="text-lg font-bold text-emerald-800">${idx+1}. ${s.title}</h4></div><p class="text-gray-600 text-sm mb-4">${s.desc}</p><div class="bg-white rounded-xl p-4 mb-3 shadow-sm"><h5 class="text-xs font-semibold text-emerald-600 uppercase mb-2">Bacaan Arab</h5><div class="arabic text-xl md:text-2xl text-gray-800 text-center leading-loose gold-text">${s.arabic}</div></div><div class="bg-white rounded-xl p-4 mb-3 shadow-sm"><h5 class="text-xs font-semibold text-blue-600 uppercase mb-2">Latin</h5><p class="text-gray-700 italic text-sm">${s.latin}</p></div><div class="bg-white rounded-xl p-4 shadow-sm"><h5 class="text-xs font-semibold text-purple-600 uppercase mb-2">Arti</h5><p class="text-gray-700 text-sm">${s.arti}</p></div></div><div class="flex justify-between mt-4">${idx>0?`<button onclick="showShalatStep(${idx-1})" class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg text-sm">â¬…ï¸ Sebelumnya</button>`:'<div></div>'}${idx<shalatSteps.length-1?`<button onclick="showShalatStep(${idx+1})" class="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-lg text-sm">Selanjutnya â¡ï¸</button>`:'<div></div>'}</div></div>`;
}

// ==================== DOA ====================
const doaCategories=[{id:'ramadhan',icon:'ğŸŒ™',label:'Ramadhan'},{id:'harian',icon:'ğŸ“¿',label:'Harian'},{id:'makan',icon:'ğŸ½ï¸',label:'Makan'},{id:'tidur',icon:'ğŸ˜´',label:'Tidur'},{id:'belajar',icon:'ğŸ“š',label:'Belajar'}];
function buildDoaNav(){document.getElementById('doaNav').innerHTML=doaCategories.map((c,i)=>`<button onclick="showDoaCategory('${c.id}')" class="doa-cat-btn ${i===0?'bg-emerald-600 text-white':'bg-gray-200 text-gray-700'} px-4 py-2 rounded-full text-xs font-medium whitespace-nowrap transition">${c.icon} ${c.label}</button>`).join('')}
function showDoaCategory(cat){
    document.querySelectorAll('.doa-cat-btn').forEach((b,i)=>{const c=doaCategories[i];b.className=`doa-cat-btn ${c.id===cat?'bg-emerald-600 text-white':'bg-gray-200 text-gray-700'} px-4 py-2 rounded-full text-xs font-medium whitespace-nowrap transition`});
    const doas=doaData[cat]||[];
    document.getElementById('doaContent').innerHTML=doas.map(d=>`<div class="bg-gradient-to-r from-emerald-50 to-amber-50 rounded-xl p-5 mb-4 border border-emerald-200 fade-in card-hover"><h4 class="font-semibold text-emerald-800 mb-3">ğŸ¤² ${d.title}</h4><div class="bg-white rounded-lg p-4 mb-3"><div class="arabic text-xl md:text-2xl text-center gold-text leading-loose">${d.arabic}</div></div><p class="text-sm text-gray-600 italic mb-1"><strong>Latin:</strong> ${d.latin}</p><p class="text-sm text-gray-700"><strong>Arti:</strong> ${d.arti}</p></div>`).join('');
}

// ==================== SUBMIT AMALIAH ====================
function submitAmaliah(e){
    e.preventDefault();const url=getGasUrl();const btn=document.getElementById('btnSubmitAmaliah');
    const data={action:'insert',username:currentUser.username,nama:currentUser.nama,kelas:currentUser.kelas,tanggal:document.getElementById('amTanggal').value,hariKe:document.getElementById('amHari').value,subuh:ck('cb_subuh'),dzuhur:ck('cb_dzuhur'),ashar:ck('cb_ashar'),maghrib:ck('cb_maghrib'),isya:ck('cb_isya'),tarawih:ck('cb_tarawih'),witir:ck('cb_witir'),dhuha:ck('cb_dhuha'),tahajud:ck('cb_tahajud'),sahur:ck('cb_sahur'),puasa:ck('cb_puasa'),sedekah:ck('cb_sedekah'),dzikir:ck('cb_dzikir'),juzBaca:document.getElementById('amJuz').value,halaman:document.getElementById('amHalaman').value,hafalanSurat:document.getElementById('amHafalan').value,catatan:document.getElementById('amCatatan').value};
    if(!url){let local=JSON.parse(localStorage.getItem('amaliahLocal')||'[]');data.Timestamp=new Date().toISOString();local.push(data);localStorage.setItem('amaliahLocal',JSON.stringify(local));showToast('âœ… Disimpan lokal!');resetAmaliahForm();return}
    btn.disabled=true;btn.innerHTML='â³ Menyimpan...';
    fetch(`${url}?${new URLSearchParams(data)}`).then(r=>r.json()).then(res=>{if(res.status==='success'){showToast('âœ… '+res.message);resetAmaliahForm()}else showToast('âŒ '+res.message)}).catch(err=>showToast('âŒ '+err.message)).finally(()=>{btn.disabled=false;btn.innerHTML='ğŸ’¾ Simpan Amaliah'});
}
function ck(id){return document.getElementById(id).checked?'âœ…':'âŒ'}
function resetAmaliahForm(){document.querySelectorAll('#formAmaliah input[type="checkbox"]').forEach(cb=>cb.checked=false);['amJuz','amHalaman','amHafalan','amCatatan'].forEach(id=>{const el=document.getElementById(id);if(el.tagName==='SELECT')el.value='';else el.value=''})}

// ==================== DATA TABLE ====================
function loadAmaliahData(){
    const url=getGasUrl();
    if(!url){const local=JSON.parse(localStorage.getItem('amaliahLocal')||'[]');allAmaliahData=local;renderAmaliahTable(local);showToast('ğŸ“‹ Data lokal dimuat.');return}
    document.getElementById('dataBody').innerHTML='<tr><td colspan="10" class="text-center py-8 text-blue-500">ğŸ”„ Memuat...</td></tr>';
    fetch(`${url}?${new URLSearchParams({action:'read',role:currentUser.role,kelas:currentUser.kelas||'',username:currentUser.username})}`).then(r=>r.json()).then(res=>{if(res.status==='success'){allAmaliahData=res.data;renderAmaliahTable(res.data);populateKelasFilter(res.data)}}).catch(err=>document.getElementById('dataBody').innerHTML=`<tr><td colspan="10" class="text-center py-8 text-red-500">âŒ ${err.message}</td></tr>`);
}
function renderAmaliahTable(data){
    if(!data.length){document.getElementById('dataBody').innerHTML='<tr><td colspan="10" class="text-center py-8 text-gray-400">Belum ada data</td></tr>';return}
    document.getElementById('dataBody').innerHTML=data.map((r,i)=>{
        const sc=['Subuh','Dzuhur','Ashar','Maghrib','Isya'].filter(k=>(r[k]||r[k.toLowerCase()])==='âœ…').length;
        const sn=['Tarawih','Witir','Dhuha','Tahajud'].filter(k=>(r[k]||r[k.toLowerCase()])==='âœ…').length;
        return`<tr class="${i%2===0?'bg-white':'bg-gray-50'} hover:bg-emerald-50"><td class="px-2 py-2 text-center">${i+1}</td><td class="px-2 py-2 font-medium">${r.Nama||r.nama||''}</td><td class="px-2 py-2 text-center">${r.Kelas||r.kelas||''}</td><td class="px-2 py-2 text-center">${r.Tanggal||r.tanggal||''}</td><td class="px-2 py-2 text-center">${r.HariKe||r.hariKe||''}</td><td class="px-2 py-2 text-center"><span class="bg-emerald-100 text-emerald-800 px-2 py-0.5 rounded-full text-xs">${sc}/5</span></td><td class="px-2 py-2 text-center"><span class="bg-amber-100 text-amber-800 px-2 py-0.5 rounded-full text-xs">${sn}/4</span></td><td class="px-2 py-2 text-center">${r.Puasa||r.puasa||''}</td><td class="px-2 py-2 text-center">${r.JuzBaca||r.juzBaca?'Juz '+(r.JuzBaca||r.juzBaca):'-'}</td><td class="px-2 py-2">${r.HafalanSurat||r.hafalanSurat||'-'}</td></tr>`;
    }).join('');
}
function populateKelasFilter(data){const kelasSet=new Set(data.map(r=>r.Kelas||r.kelas).filter(Boolean));const sel=document.getElementById('filterKelas');sel.innerHTML='<option value="">Semua Kelas</option>'+[...kelasSet].sort().map(k=>`<option value="${k}">${k}</option>`).join('')}
function filterAmaliahData(){const search=(document.getElementById('searchData').value||'').toLowerCase();const kelas=document.getElementById('filterKelas').value;renderAmaliahTable(allAmaliahData.filter(r=>{const nama=(r.Nama||r.nama||'').toLowerCase();const rKelas=r.Kelas||r.kelas||'';return nama.includes(search)&&(!kelas||rKelas===kelas)}))}

// ==================== PROGRESS ====================
function loadMyProgress(){
    const url=getGasUrl();
    if(url){document.getElementById('progressContent').innerHTML='<p class="text-center text-blue-500 py-8">ğŸ”„ Memuat...</p>';
        fetch(`${url}?${new URLSearchParams({action:'read',role:'siswa',username:currentUser.username})}`).then(r=>r.json()).then(res=>{if(res.status==='success')renderProgress(res.data)}).catch(err=>document.getElementById('progressContent').innerHTML=`<p class="text-center text-red-500">âŒ ${err.message}</p>`);
    }else{const data=JSON.parse(localStorage.getItem('amaliahLocal')||'[]').filter(r=>(r.username||r.Username)===currentUser.username);renderProgress(data)}
}
function renderProgress(data){
    if(!data.length){document.getElementById('progressContent').innerHTML='<p class="text-center text-gray-400 py-8">Belum ada data amaliah.</p>';return}
    const totalDays=data.length;let totalShalat=0,totalSunnah=0,totalPuasa=0;
    data.forEach(r=>{['Subuh','Dzuhur','Ashar','Maghrib','Isya'].forEach(k=>{if((r[k]||r[k.toLowerCase()])==='âœ…')totalShalat++});['Tarawih','Witir','Dhuha','Tahajud'].forEach(k=>{if((r[k]||r[k.toLowerCase()])==='âœ…')totalSunnah++});if((r.Puasa||r.puasa)==='âœ…')totalPuasa++});
    const sp=Math.round(totalShalat/(totalDays*5)*100),snp=Math.round(totalSunnah/(totalDays*4)*100),pp=Math.round(totalPuasa/totalDays*100);
    document.getElementById('progressContent').innerHTML=`<div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"><div class="bg-emerald-50 rounded-xl p-4 text-center"><div class="text-3xl font-bold text-emerald-700">${totalDays}</div><div class="text-xs text-gray-500">Hari Tercatat</div></div><div class="bg-blue-50 rounded-xl p-4 text-center"><div class="text-3xl font-bold text-blue-700">${sp}%</div><div class="text-xs text-gray-500">Shalat 5 Waktu</div></div><div class="bg-amber-50 rounded-xl p-4 text-center"><div class="text-3xl font-bold text-amber-700">${snp}%</div><div class="text-xs text-gray-500">Ibadah Sunnah</div></div><div class="bg-purple-50 rounded-xl p-4 text-center"><div class="text-3xl font-bold text-purple-700">${pp}%</div><div class="text-xs text-gray-500">Puasa</div></div></div>
    <div class="space-y-3"><div><div class="flex justify-between text-sm mb-1"><span>ğŸ•Œ Shalat</span><span class="font-semibold">${sp}%</span></div><div class="bg-gray-200 rounded-full h-3"><div class="bg-emerald-500 rounded-full h-3" style="width:${sp}%"></div></div></div><div><div class="flex justify-between text-sm mb-1"><span>â­ Sunnah</span><span class="font-semibold">${snp}%</span></div><div class="bg-gray-200 rounded-full h-3"><div class="bg-amber-500 rounded-full h-3" style="width:${snp}%"></div></div></div><div><div class="flex justify-between text-sm mb-1"><span>ğŸ•Œ Puasa</span><span class="font-semibold">${pp}%</span></div><div class="bg-gray-200 rounded-full h-3"><div class="bg-purple-500 rounded-full h-3" style="width:${pp}%"></div></div></div></div>`;
}

// ==================== USER MANAGEMENT ====================
function showAddUserForm(){document.getElementById('addUserForm').classList.remove('hidden')}
function loadUsers(){
    const url=getGasUrl();
    if(!url){allUsersData=DEFAULT_ACCOUNTS.map(a=>({username:a.username,nama:a.nama,role:a.role,kelas:a.kelas,status:'offline'}));renderUsersTable(allUsersData);showToast('âš ï¸ Mode Offline â€” Hubungkan ke Spreadsheet untuk data real');return}
    document.getElementById('userBody').innerHTML='<tr><td colspan="6" class="text-center py-8 text-blue-500">ğŸ”„ Memuat...</td></tr>';
    fetch(`${url}?action=getUsers`).then(r=>r.json()).then(res=>{if(res.status==='success'){allUsersData=res.data;renderUsersTable(res.data)}}).catch(err=>document.getElementById('userBody').innerHTML=`<tr><td colspan="6" class="text-center py-8 text-red-500">âŒ ${err.message}</td></tr>`);
}
function renderUsersTable(data){
    if(!data.length){document.getElementById('userBody').innerHTML='<tr><td colspan="6" class="text-center py-8 text-gray-400">Belum ada user</td></tr>';return}
    const rc={siswa:'bg-blue-100 text-blue-800',guru:'bg-green-100 text-green-800',wali:'bg-amber-100 text-amber-800',admin:'bg-red-100 text-red-800'};
    document.getElementById('userBody').innerHTML=data.map((u,i)=>`<tr class="${i%2===0?'bg-white':'bg-gray-50'} hover:bg-emerald-50"><td class="px-3 py-2 text-center">${i+1}</td><td class="px-3 py-2 font-medium">${u.username}</td><td class="px-3 py-2">${u.nama}</td><td class="px-3 py-2"><span class="${rc[u.role]||'bg-gray-100'} px-2 py-0.5 rounded-full text-xs">${ROLE_LABELS[u.role]||u.role}</span></td><td class="px-3 py-2 text-center">${u.kelas||'-'}</td><td class="px-3 py-2 text-center">${u.username!=='admin'?`<button onclick="deleteUserConfirm('${u.username}')" class="bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs">ğŸ—‘ï¸</button>`:'<span class="text-xs text-gray-400">Protected</span>'}</td></tr>`).join('');
}
function filterUsers(){const role=document.getElementById('filterUserRole').value;renderUsersTable(role?allUsersData.filter(u=>u.role===role):allUsersData)}
function addUser(){
    const url=getGasUrl(),username=document.getElementById('newUsername').value.trim(),password=document.getElementById('newPassword').value.trim(),nama=document.getElementById('newNama').value.trim(),role=document.getElementById('newRole').value,kelas=document.getElementById('newKelas').value.trim();
    if(!username||!password||!nama){showToast('âš ï¸ Isi semua field!');return}
    if(!url){showToast('âš ï¸ Hubungkan GAS dulu!');return}
    fetch(`${url}?${new URLSearchParams({action:'addUser',username,password,nama,role,kelas})}`).then(r=>r.json()).then(res=>{showToast(res.status==='success'?'âœ… '+res.message:'âŒ '+res.message);if(res.status==='success'){document.getElementById('addUserForm').classList.add('hidden');['newUsername','newPassword','newNama','newKelas'].forEach(id=>document.getElementById(id).value='');loadUsers()}}).catch(err=>showToast('âŒ '+err.message));
}
function deleteUserConfirm(username){
    if(!confirm(`Yakin hapus user "${username}"?`))return;const url=getGasUrl();if(!url){showToast('âš ï¸ Hubungkan GAS!');return}
    fetch(`${url}?action=deleteUser&username=${encodeURIComponent(username)}`).then(r=>r.json()).then(res=>{showToast(res.status==='success'?'âœ… '+res.message:'âŒ '+res.message);loadUsers()}).catch(err=>showToast('âŒ '+err.message));
}

// ==================== SETUP ====================
function getGasUrl(){return localStorage.getItem('gasUrl')||''}
function onSpreadsheetIdChange(){localStorage.setItem('spreadsheetId',document.getElementById('spreadsheetId').value.trim());updateGasCodeDisplay();updateIdStatus()}
function updateIdStatus(){
    const ssId=(document.getElementById('spreadsheetId')?document.getElementById('spreadsheetId').value.trim():'')||localStorage.getItem('spreadsheetId')||'';
    const el=document.getElementById('idStatus');if(!el)return;
    if(ssId&&ssId.length>10){el.innerHTML=`<div class="bg-green-100 border-2 border-green-400 rounded-xl p-4 flex items-start gap-3"><div class="text-2xl">âœ…</div><div><p class="font-bold text-green-800">Spreadsheet ID Terdeteksi!</p><p class="text-sm text-green-700 mt-1">ID: <code class="bg-green-200 px-2 py-0.5 rounded font-mono text-xs break-all">${ssId}</code></p><p class="text-sm text-green-600 mt-1">â†’ ID sudah <b>tertanam otomatis</b> di kode GAS. Tinggal copy!</p></div></div>`}
    else{el.innerHTML=`<div class="bg-red-100 border-2 border-red-300 rounded-xl p-4 flex items-start gap-3"><div class="text-2xl">âš ï¸</div><div><p class="font-bold text-red-800">Spreadsheet ID Belum Dimasukkan</p><p class="text-sm text-red-600 mt-1">Masukkan ID di atas agar kode GAS berisi ID Spreadsheet Anda.</p></div></div>`}
}
function updateGasCodeDisplay(){
    const ssIdInput=document.getElementById('spreadsheetId');const ssId=ssIdInput?ssIdInput.value.trim():(localStorage.getItem('spreadsheetId')||'');
    const codeEl=document.getElementById('gasCode');const previewEl=document.getElementById('previewId');
    if(codeEl)codeEl.textContent=generateGasCode(ssId);
    if(previewEl){if(ssId&&ssId.length>10){previewEl.textContent=ssId;previewEl.className='text-yellow-300 font-bold'}else{previewEl.textContent='BELUM_DIISI â€” Masukkan ID di Step 1';previewEl.className='text-red-400 font-bold'}}
}
function toggleCodeView(){const c=document.getElementById('gasCodeContainer');const btn=document.getElementById('btnToggleCode');if(c.classList.contains('hidden')){c.classList.remove('hidden');btn.textContent='ğŸ™ˆ Sembunyikan'}else{c.classList.add('hidden');btn.textContent='ğŸ‘ï¸ Lihat Kode'}}
function saveSetup(){
    const ssId=document.getElementById('spreadsheetId').value.trim(),url=document.getElementById('gasUrl').value.trim();
    if(ssId)localStorage.setItem('spreadsheetId',ssId);if(url)localStorage.setItem('gasUrl',url);
    if(ssId||url){updateGasCodeDisplay();updateIdStatus();showToast('âœ… Pengaturan disimpan!')}else showToast('âš ï¸ Masukkan ID atau URL!');
}
function loadSetupFields(){const ssId=localStorage.getItem('spreadsheetId');const url=localStorage.getItem('gasUrl');if(ssId&&document.getElementById('spreadsheetId'))document.getElementById('spreadsheetId').value=ssId;if(url&&document.getElementById('gasUrl'))document.getElementById('gasUrl').value=url;updateGasCodeDisplay();updateIdStatus()}
function testConnection(){
    const url=getGasUrl(),st=document.getElementById('connectionStatus');
    if(!url){st.innerHTML='<span class="text-red-600">âŒ URL belum diatur!</span>';return}
    st.innerHTML='<span class="text-blue-600">ğŸ”„ Menguji...</span>';
    fetch(`${url}?action=test`).then(r=>r.json()).then(d=>{st.innerHTML=d.status==='success'?`<span class="text-green-600">âœ… ${d.message}</span>`:`<span class="text-red-600">âŒ ${d.message}</span>`}).catch(err=>st.innerHTML=`<span class="text-red-600">âŒ ${err.message}</span>`);
}
function initSheets(){
    const url=getGasUrl(),st=document.getElementById('connectionStatus');
    if(!url){st.innerHTML='<span class="text-red-600">âŒ URL belum diatur!</span>';return}
    st.innerHTML='<span class="text-blue-600">ğŸ”„ Membuat database...</span>';
    fetch(`${url}?action=init`).then(r=>r.json()).then(d=>{if(d.status==='success'){st.innerHTML=`<span class="text-green-600">âœ… ${d.message}</span>`;showToast('âœ… Database siap!')}else st.innerHTML=`<span class="text-red-600">âŒ ${d.message}</span>`}).catch(err=>st.innerHTML=`<span class="text-red-600">âŒ ${err.message}</span>`);
}
function copyGasCode(){
    const ssId=document.getElementById('spreadsheetId')?document.getElementById('spreadsheetId').value.trim():localStorage.getItem('spreadsheetId')||'';
    const code=generateGasCode(ssId);
    navigator.clipboard.writeText(code).then(()=>{if(ssId&&ssId.length>10)showToast('âœ… Kode GAS disalin! (ID Spreadsheet sudah tertanam)');else showToast('âš ï¸ Kode disalin, tapi ID belum diisi!')}).catch(()=>{const ta=document.createElement('textarea');ta.value=code;document.body.appendChild(ta);ta.select();document.execCommand('copy');document.body.removeChild(ta);showToast('âœ… Kode berhasil disalin!')});
}

// ==================== UTILITIES ====================
function showToast(msg){const t=document.getElementById('toast');document.getElementById('toastMsg').textContent=msg;t.className='toast show '+(msg.includes('âŒ')||msg.includes('âš ï¸')?'bg-red-600':'bg-green-600')+' text-white px-6 py-3 rounded-lg shadow-xl flex items-center gap-2';setTimeout(()=>t.classList.remove('show'),4000)}
document.addEventListener('keydown',e=>{if(e.key==='Escape'){closeSurahModal();closeHafalanModal()}});
</script>
</body>
</html>
